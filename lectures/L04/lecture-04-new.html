<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.39">

  <meta name="author" content="Januar Harianto">
  <title>Lecture 04 – The central limit theorem</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-36901135a4c03f67af99f2d642dc10fc.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="../../site_libs/quarto-contrib/quarto-project/soles/title-slide.png" data-background-size="contain" class="quarto-title-block center">
  <h1 class="title">Lecture 04 – The central limit theorem</h1>
  <p class="subtitle">ENVX1002 Introduction to Statistical Methods</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Januar Harianto 
</div>
        <p class="quarto-title-affiliation">
            The University of Sydney
          </p>
    </div>
</div>

  <p class="date">Mar 2025</p>
</section>
<section id="learning-outcomes" class="slide level2">
<h2>Learning Outcomes</h2>
<h3 id="at-the-end-of-this-week-you-will-be-able-to">At the end of this week, you will be able to:</h3>
<ol type="1">
<li>Define probability distributions and their key properties</li>
<li>Apply the normal distribution to calculate probabilities</li>
<li>Standardise variables using the normal distribution</li>
<li>Differentiate between population, sample and sampling distributions</li>
<li>Explain the difference between standard deviation and standard error</li>
<li>Apply the central limit theorem and understand its significance</li>
<li>Use R to implement these statistical concepts</li>
</ol>
</section>
<section id="quick-checklist" class="slide level2">
<h2>Quick checklist</h2>
<ul class="task-list">
<li><label><input type="checkbox">Create and edit Quarto documents</label></li>
<li><label><input type="checkbox">Understand the concept of central tendency and spread/dispersion</label></li>
<li><label><input type="checkbox">Interpret skewness (and kurtosis) in a distribution of data</label></li>
<li><label><input type="checkbox">Know that different data types require different approaches to summarising data</label></li>
<li><label><input type="checkbox">Generate some plots in <code>ggplot2</code></label></li>
</ul>
</section>
<section>
<section id="probability-distributions" class="title-slide slide level1 center">
<h1>Probability distributions</h1>

</section>
<section id="example-rainfall" class="slide level2 scrollable">
<h2>Example: rainfall</h2>
<p>Consider measuring daily rainfall amounts in a coastal wetland. <em>Some</em> days have no rain. <strong>Most</strong> days have small to moderate amounts. <em>Few</em> days have very heavy rainfall.</p>
<div class="fragment">
<p>This creates a pattern of variation in rainfall amounts, which at some point we can predict. This pattern is what we call a <strong>probability distribution</strong> (i.e.&nbsp;we can calculate the probability of a certain amount of rainfall on a given day).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a></a>rainfall_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-3"><a></a>  <span class="at">rainfall =</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">5</span>)</span>
<span id="cb1-4"><a></a>)</span>
<span id="cb1-5"><a></a></span>
<span id="cb1-6"><a></a>p_rainfall <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rainfall_data, <span class="fu">aes</span>(<span class="at">x =</span> rainfall)) <span class="sc">+</span></span>
<span id="cb1-7"><a></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb1-8"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb1-9"><a></a>    <span class="at">x =</span> <span class="st">"Daily Rainfall (mm)"</span>,</span>
<span id="cb1-10"><a></a>    <span class="at">y =</span> <span class="st">"Frequency"</span></span>
<span id="cb1-11"><a></a>  )</span>
<span id="cb1-12"><a></a>p_rainfall</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture-04-new_files/figure-revealjs/rainfall-sim-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="probability-distribution" class="slide level2">
<h2>Probability distribution?</h2>
<p>A probability distribution is a function or equation that tells us:</p>
<ul>
<li>How likely different values are to occur</li>
<li>The pattern of variation in our measurements</li>
<li>The range and spread of possible values</li>
</ul>
<p>It is like a mathematical recipe for how values are distributed.</p>
<div class="fragment">
<h3 id="different-types-of-distributions">Different types of distributions</h3>
<p>Depending on the data, distributions can be:</p>
<ul>
<li>Discrete (e.g.&nbsp;number of trees in 100m<sup>2</sup> of forest) – probability <strong>distribution</strong> function <span class="math inline">P = f(x)</span>
<ul>
<li>What is the probability that 100m<sup>2</sup> of forest contains 50 trees?</li>
</ul></li>
<li>Continuous (e.g.&nbsp;rainfall amounts over a period) – probability <strong>density</strong> function <span class="math inline">f(x)</span>
<ul>
<li>What is the probability of rainfall between 10-20mm a day?</li>
</ul></li>
<li>Both discrete and continuous (e.g.&nbsp;age of trees) <span class="math inline">F(x) = P(X \leq x)</span>
<ul>
<li>What is the probability that a tree is older than 50 years?</li>
</ul></li>
</ul>
</div>
</section>
<section id="properties-of-distributions" class="slide level2">
<h2>Properties of distributions</h2>
<p>We now combine all of what we have learnt about data in the last 3 weeks:</p>
<ul>
<li><strong>Central tendency</strong> – mean, median, mode</li>
<li><strong>Spread</strong> – standard deviation, variance</li>
<li><strong>Shape</strong> – symmetry, skewness</li>
<li><strong>Tails</strong> – how quickly they “decay” towards zero</li>
</ul>
<p>But how do we use these properties to make predictions? <strong>Do some distributions have special properties?</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="co"># Annotate our rainfall distribution with key properties</span></span>
<span id="cb2-2"><a></a>p_rainfall <span class="sc">+</span></span>
<span id="cb2-3"><a></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb2-4"><a></a>    <span class="at">xintercept =</span> <span class="fu">mean</span>(rainfall_data<span class="sc">$</span>rainfall),</span>
<span id="cb2-5"><a></a>    <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb2-6"><a></a>  ) <span class="sc">+</span></span>
<span id="cb2-7"><a></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb2-8"><a></a>    <span class="at">x =</span> <span class="fu">mean</span>(rainfall_data<span class="sc">$</span>rainfall), <span class="at">y =</span> <span class="dv">100</span>,</span>
<span id="cb2-9"><a></a>    <span class="at">label =</span> <span class="st">"Mean"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb2-10"><a></a>  ) <span class="sc">+</span></span>
<span id="cb2-11"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb2-12"><a></a>    <span class="at">x =</span> <span class="st">"Daily Rainfall (mm)"</span>,</span>
<span id="cb2-13"><a></a>    <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb2-14"><a></a>    <span class="at">title =</span> <span class="st">"Can we use the mean to predict rainfall?"</span></span>
<span id="cb2-15"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/dist-properties-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="the-general-normal-distribution" class="title-slide slide level1 center">
<h1>The general normal distribution</h1>

</section>
<section id="tree-heights" class="slide level2">
<h2>Tree heights</h2>
<p>Tree heights in a forest often follow a normal distribution:</p>
<ul>
<li>Most trees cluster around the average height</li>
<li>Fewer trees are very short or very tall</li>
<li>The pattern is symmetrical – a bell-shaped curve with two parameters (mean <span class="math inline">\mu</span> and standard deviation <span class="math inline">\sigma</span>) such that <span class="math display">X \sim N(\mu, \sigma^2)</span></li>
</ul>
</section>
<section id="comparing-distributions" class="slide level2">
<h2>Comparing distributions</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="co"># Set up the data</span></span>
<span id="cb3-2"><a></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-3"><a></a>tree_heights <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-4"><a></a>  <span class="at">height =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb3-5"><a></a>)</span>
<span id="cb3-6"><a></a></span>
<span id="cb3-7"><a></a><span class="co"># Create plots for comparison</span></span>
<span id="cb3-8"><a></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rainfall_data, <span class="fu">aes</span>(<span class="at">x =</span> rainfall)) <span class="sc">+</span></span>
<span id="cb3-9"><a></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb3-10"><a></a>    <span class="at">binwidth =</span> <span class="dv">2</span>,</span>
<span id="cb3-11"><a></a>    <span class="at">fill =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb3-12"><a></a>    <span class="at">colour =</span> <span class="st">"white"</span></span>
<span id="cb3-13"><a></a>  ) <span class="sc">+</span></span>
<span id="cb3-14"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb3-15"><a></a>    <span class="at">x =</span> <span class="st">"Daily Rainfall (mm)"</span>,</span>
<span id="cb3-16"><a></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb3-17"><a></a>    <span class="at">title =</span> <span class="st">"Skewed Distribution</span><span class="sc">\n</span><span class="st">(Rainfall)"</span></span>
<span id="cb3-18"><a></a>  )</span>
<span id="cb3-19"><a></a></span>
<span id="cb3-20"><a></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tree_heights, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb3-21"><a></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb3-22"><a></a>    <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb3-23"><a></a>    <span class="at">fill =</span> <span class="st">"forestgreen"</span>,</span>
<span id="cb3-24"><a></a>    <span class="at">colour =</span> <span class="st">"white"</span></span>
<span id="cb3-25"><a></a>  ) <span class="sc">+</span></span>
<span id="cb3-26"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb3-27"><a></a>    <span class="at">x =</span> <span class="st">"Tree Height (m)"</span>,</span>
<span id="cb3-28"><a></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb3-29"><a></a>    <span class="at">title =</span> <span class="st">"Normal Distribution</span><span class="sc">\n</span><span class="st">(Tree Heights)"</span></span>
<span id="cb3-30"><a></a>  )</span>
<span id="cb3-31"><a></a></span>
<span id="cb3-32"><a></a><span class="co"># Arrange plots side by side</span></span>
<span id="cb3-33"><a></a><span class="fu">plot_grid</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/compare-dist-1.png" width="960" class="r-stretch"></section>
<section id="why-do-tree-heights-follow-a-normal-distribution" class="slide level2">
<h2>Why do tree heights follow a normal distribution?</h2>
<ol type="1">
<li>The middle (mean) height is most common – most trees are around 20 metres tall</li>
<li>Heights spread out evenly on both sides – as many short trees as tall trees, like a mirror image around the middle</li>
<li>Extreme heights are rare – very few extremely short or tall trees – numbers decrease gradually as we move away from the middle</li>
</ol>
<p>The normal distribution is a natural phenomenon in many real-world situations – a <strong>fundamental</strong> concept in statistics.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/tree-heights-1.png" width="960" class="r-stretch"></section>
<section id="a-continuous-distribution" class="slide level2">
<h2>A continuous distribution</h2>
<ul>
<li>There is an infinite number of possible heights within a certain range (e.g.&nbsp;0-40m)</li>
<li>We can calculate the probability of a tree being a certain height or within a range</li>
<li>Some heights have a probability of zero (e.g.&nbsp;negative heights, or heights above 40m)</li>
</ul>
<p>We can use these properties to make reasonable predictions about tree heights:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="co"># Calculate mean and standard deviations</span></span>
<span id="cb5-2"><a></a>mean_height <span class="ot">&lt;-</span> <span class="fu">mean</span>(tree_heights<span class="sc">$</span>height)</span>
<span id="cb5-3"><a></a>sd_height <span class="ot">&lt;-</span> <span class="fu">sd</span>(tree_heights<span class="sc">$</span>height)</span>
<span id="cb5-4"><a></a></span>
<span id="cb5-5"><a></a><span class="co"># Create plot with standard deviation ranges</span></span>
<span id="cb5-6"><a></a>p2 <span class="sc">+</span></span>
<span id="cb5-7"><a></a>  <span class="co"># Add vertical lines for mean and SDs</span></span>
<span id="cb5-8"><a></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb5-9"><a></a>    <span class="at">xintercept =</span> mean_height,</span>
<span id="cb5-10"><a></a>    <span class="at">colour =</span> <span class="st">"darkred"</span>,</span>
<span id="cb5-11"><a></a>    <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb5-12"><a></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb5-13"><a></a>  ) <span class="sc">+</span></span>
<span id="cb5-14"><a></a>  <span class="co"># Add SD ranges</span></span>
<span id="cb5-15"><a></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>,</span>
<span id="cb5-16"><a></a>    <span class="at">xmin =</span> mean_height <span class="sc">-</span> sd_height,</span>
<span id="cb5-17"><a></a>    <span class="at">xmax =</span> mean_height <span class="sc">+</span> sd_height,</span>
<span id="cb5-18"><a></a>    <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb5-19"><a></a>    <span class="at">fill =</span> <span class="st">"yellow"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span></span>
<span id="cb5-20"><a></a>  ) <span class="sc">+</span></span>
<span id="cb5-21"><a></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>,</span>
<span id="cb5-22"><a></a>    <span class="at">xmin =</span> mean_height <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> sd_height,</span>
<span id="cb5-23"><a></a>    <span class="at">xmax =</span> mean_height <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> sd_height,</span>
<span id="cb5-24"><a></a>    <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb5-25"><a></a>    <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span></span>
<span id="cb5-26"><a></a>  ) <span class="sc">+</span></span>
<span id="cb5-27"><a></a>  <span class="co"># Add labels</span></span>
<span id="cb5-28"><a></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb5-29"><a></a>    <span class="at">x =</span> mean_height, <span class="at">y =</span> <span class="fl">0.15</span>,</span>
<span id="cb5-30"><a></a>    <span class="at">label =</span> <span class="st">"Mean"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb5-31"><a></a>  ) <span class="sc">+</span></span>
<span id="cb5-32"><a></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb5-33"><a></a>    <span class="at">x =</span> mean_height <span class="sc">-</span> sd_height<span class="sc">/</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fl">0.12</span>,</span>
<span id="cb5-34"><a></a>    <span class="at">label =</span> <span class="st">"68% within</span><span class="sc">\n</span><span class="st">1 SD"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb5-35"><a></a>  ) <span class="sc">+</span></span>
<span id="cb5-36"><a></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb5-37"><a></a>    <span class="at">x =</span> mean_height <span class="sc">-</span> sd_height, <span class="at">y =</span> <span class="fl">0.09</span>,</span>
<span id="cb5-38"><a></a>    <span class="at">label =</span> <span class="st">"95% within</span><span class="sc">\n</span><span class="st">2 SD"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb5-39"><a></a>  ) <span class="sc">+</span></span>
<span id="cb5-40"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb5-41"><a></a>    <span class="at">x =</span> <span class="st">"Tree Height (m)"</span>,</span>
<span id="cb5-42"><a></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb5-43"><a></a>    <span class="at">title =</span> <span class="st">"Normal Distribution</span><span class="sc">\n</span><span class="st">(Tree Heights)"</span></span>
<span id="cb5-44"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/spread-visual-1.png" width="960" class="r-stretch"></section>
<section id="the-68-95-99.7-rule" class="slide level2">
<h2>The 68-95-99.7 rule</h2>
<p>A data that follows a normal distribution:</p>
<ul>
<li>About 68% of values fall within 1 standard deviation</li>
<li>About 95% fall within 2 standard deviations</li>
<li>About 99.7% fall within 3 standard deviations</li>
<li>The remaining 0.3% are extreme values and extend to infinity</li>
</ul>
<p>This pattern is the same for ALL normal distributions – a <strong>universal</strong> rule.</p>
<p>Importantly, it is a <strong>predictable</strong> pattern (although not exact).</p>
</section>
<section id="from-data-to-normal-distribution" class="slide level2">
<h2>From data to normal distribution</h2>
<ul>
<li>When data follows a reasonably normal pattern, we can “fit” a normal distribution to make <em>equally</em> reasonable predictions.</li>
<li>It is possible to fit a normal distribution to a skewed distribution (but <strong>not recommended</strong> – other techniques exist)</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a><span class="co"># Calculate statistics for both distributions</span></span>
<span id="cb6-2"><a></a>tree_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(tree_heights<span class="sc">$</span>height)</span>
<span id="cb6-3"><a></a>tree_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(tree_heights<span class="sc">$</span>height)</span>
<span id="cb6-4"><a></a>rain_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(rainfall_data<span class="sc">$</span>rainfall)</span>
<span id="cb6-5"><a></a>rain_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(rainfall_data<span class="sc">$</span>rainfall)</span>
<span id="cb6-6"><a></a></span>
<span id="cb6-7"><a></a><span class="co"># Create comparison plots showing fitted normal curves</span></span>
<span id="cb6-8"><a></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tree_heights, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb6-9"><a></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb6-10"><a></a>    <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb6-11"><a></a>    <span class="at">fill =</span> <span class="st">"forestgreen"</span>,</span>
<span id="cb6-12"><a></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb6-13"><a></a>    <span class="at">alpha =</span> <span class="fl">0.7</span></span>
<span id="cb6-14"><a></a>  ) <span class="sc">+</span></span>
<span id="cb6-15"><a></a>  <span class="co"># Add fitted normal curve</span></span>
<span id="cb6-16"><a></a>  <span class="fu">stat_function</span>(</span>
<span id="cb6-17"><a></a>    <span class="at">fun =</span> dnorm,</span>
<span id="cb6-18"><a></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> tree_mean, <span class="at">sd =</span> tree_sd),</span>
<span id="cb6-19"><a></a>    <span class="at">colour =</span> <span class="st">"darkred"</span>,</span>
<span id="cb6-20"><a></a>    <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb6-21"><a></a>  ) <span class="sc">+</span></span>
<span id="cb6-22"><a></a>  <span class="co"># Add mean line and 1 SD range</span></span>
<span id="cb6-23"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> tree_mean, <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb6-24"><a></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>,</span>
<span id="cb6-25"><a></a>    <span class="at">xmin =</span> tree_mean <span class="sc">-</span> tree_sd,</span>
<span id="cb6-26"><a></a>    <span class="at">xmax =</span> tree_mean <span class="sc">+</span> tree_sd,</span>
<span id="cb6-27"><a></a>    <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb6-28"><a></a>    <span class="at">fill =</span> <span class="st">"yellow"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span></span>
<span id="cb6-29"><a></a>  ) <span class="sc">+</span></span>
<span id="cb6-30"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb6-31"><a></a>    <span class="at">x =</span> <span class="st">"Tree Height (m)"</span>,</span>
<span id="cb6-32"><a></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb6-33"><a></a>    <span class="at">title =</span> <span class="st">"Normal Data:</span><span class="sc">\n</span><span class="st">Can Fit Normal Distribution"</span></span>
<span id="cb6-34"><a></a>  )</span>
<span id="cb6-35"><a></a></span>
<span id="cb6-36"><a></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rainfall_data, <span class="fu">aes</span>(<span class="at">x =</span> rainfall)) <span class="sc">+</span></span>
<span id="cb6-37"><a></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),</span>
<span id="cb6-38"><a></a>    <span class="at">binwidth =</span> <span class="dv">2</span>,</span>
<span id="cb6-39"><a></a>    <span class="at">fill =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb6-40"><a></a>    <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb6-41"><a></a>    <span class="at">alpha =</span> <span class="fl">0.7</span></span>
<span id="cb6-42"><a></a>  ) <span class="sc">+</span></span>
<span id="cb6-43"><a></a>  <span class="co"># Try to fit normal curve (shows poor fit)</span></span>
<span id="cb6-44"><a></a>  <span class="fu">stat_function</span>(</span>
<span id="cb6-45"><a></a>    <span class="at">fun =</span> dnorm,</span>
<span id="cb6-46"><a></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> rain_mean, <span class="at">sd =</span> rain_sd),</span>
<span id="cb6-47"><a></a>    <span class="at">colour =</span> <span class="st">"darkred"</span>,</span>
<span id="cb6-48"><a></a>    <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb6-49"><a></a>  ) <span class="sc">+</span></span>
<span id="cb6-50"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> rain_mean, <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb6-51"><a></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>,</span>
<span id="cb6-52"><a></a>    <span class="at">xmin =</span> rain_mean <span class="sc">-</span> rain_sd,</span>
<span id="cb6-53"><a></a>    <span class="at">xmax =</span> rain_mean <span class="sc">+</span> rain_sd,</span>
<span id="cb6-54"><a></a>    <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb6-55"><a></a>    <span class="at">fill =</span> <span class="st">"yellow"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span></span>
<span id="cb6-56"><a></a>  ) <span class="sc">+</span></span>
<span id="cb6-57"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb6-58"><a></a>    <span class="at">x =</span> <span class="st">"Rainfall (mm)"</span>,</span>
<span id="cb6-59"><a></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb6-60"><a></a>    <span class="at">title =</span> <span class="st">"Skewed Data:</span><span class="sc">\n</span><span class="st">Poor Normal Fit"</span></span>
<span id="cb6-61"><a></a>  )</span>
<span id="cb6-62"><a></a></span>
<span id="cb6-63"><a></a><span class="fu">plot_grid</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/predictability-1.png" width="960" class="r-stretch"></section>
<section id="when-data-is-normal" class="slide level2">
<h2>When data is normal…</h2>
<ol type="1">
<li>We can use normal probability functions to:
<ul>
<li>Calculate exact probabilities</li>
<li>Find specific percentiles</li>
<li>Make reliable predictions</li>
</ul></li>
<li>Properties are predictable (the 68-95-99.7 rule)</li>
<li>Can standardise measurements (<strong>more on this later</strong>)
<ul>
<li>Compare different variables</li>
<li>Use z-scores</li>
<li><strong>Apply statistical tests</strong></li>
</ul></li>
</ol>
</section>
<section id="working-with-normal-distributions-in-r" class="slide level2 scrollable">
<h2>Working with normal distributions in R</h2>
<p>R provides three main functions that help us work with normal distributions. Think of them as different ways to ask questions about our data:</p>
<h3 id="pnorm-whats-the-probability">1. <code>pnorm()</code>: “What’s the probability?”</h3>
<ul>
<li>Like asking “What proportion of trees are shorter than X meters?”
<ul>
<li>Probability of a tree being under 15m tall</li>
<li>Chance of rainfall being less than 50mm</li>
<li>Proportion of measurements below average</li>
</ul></li>
</ul>
</section>
<section id="working-with-normal-distributions-in-r-1" class="slide level2 scrollable">
<h2>Working with normal distributions in R</h2>
<p>R provides three main functions that help us work with normal distributions. Think of them as different ways to ask questions about our data:</p>
<h3 id="qnorm-whats-the-value">2. <code>qnorm()</code>: “What’s the value?”</h3>
<ul>
<li>Like asking “How tall are the shortest 10% of trees?”
<ul>
<li>Finding the height that only 5% of trees exceed</li>
<li>Determining rainfall threshold for “extreme” events</li>
<li>Identifying typical range boundaries</li>
</ul></li>
</ul>
</section>
<section id="working-with-normal-distributions-in-r-2" class="slide level2 scrollable">
<h2>Working with normal distributions in R</h2>
<p>R provides three main functions that help us work with normal distributions. Think of them as different ways to ask questions about our data:</p>
<h3 id="dnorm-whats-the-relative-likelihood">3. <code>dnorm()</code>: “What’s the relative likelihood?”</h3>
<ul>
<li>Like asking “How common is this exact height?”
<ul>
<li>Comparing how likely different heights are</li>
<li>Finding peak probability</li>
<li>Plotting the normal curve shape</li>
</ul></li>
</ul>
</section>
<section id="using-pnorm-for-probabilities" class="slide level2">
<h2>Using <code>pnorm()</code> for probabilities</h2>
<p>What proportion of trees in our forest are shorter than 23m, knowing that mean height is 20m and the sd is 3m?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>prob_under_23 <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="at">q =</span> <span class="dv">23</span>, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>) <span class="co"># Calculate proportion of trees under 23m</span></span>
<span id="cb7-2"><a></a>prob_under_23</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8413447</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="co"># Visualise the probability</span></span>
<span id="cb9-2"><a></a>percent_under_23 <span class="ot">&lt;-</span> prob_under_23 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb9-3"><a></a></span>
<span id="cb9-4"><a></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">30</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb9-5"><a></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb9-6"><a></a>  <span class="fu">geom_area</span>(</span>
<span id="cb9-7"><a></a>    <span class="at">stat =</span> <span class="st">"function"</span>, <span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>),</span>
<span id="cb9-8"><a></a>    <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">23</span>)</span>
<span id="cb9-9"><a></a>  ) <span class="sc">+</span></span>
<span id="cb9-10"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">23</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb9-11"><a></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb9-12"><a></a>    <span class="at">x =</span> <span class="dv">23</span>, <span class="at">y =</span> <span class="fl">0.02</span>,</span>
<span id="cb9-13"><a></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%% of trees"</span>, percent_under_23),</span>
<span id="cb9-14"><a></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span></span>
<span id="cb9-15"><a></a>  ) <span class="sc">+</span></span>
<span id="cb9-16"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb9-17"><a></a>    <span class="at">x =</span> <span class="st">"Tree Height (m)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb9-18"><a></a>    <span class="at">title =</span> <span class="st">"Tree Heights Below 23m"</span></span>
<span id="cb9-19"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/pnorm-visual-1.png" width="960" class="r-stretch"></section>
<section id="using-qnorm-for-thresholds" class="slide level2">
<h2>Using <code>qnorm()</code> for thresholds</h2>
<p>How tall are the largest 10% of trees in our forest?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="co"># Find the height threshold for tallest 10%</span></span>
<span id="cb10-2"><a></a>height_90th <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.90</span>, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb10-3"><a></a>height_90th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 23.84465</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a><span class="co"># Visualise the threshold</span></span>
<span id="cb12-2"><a></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">30</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb12-3"><a></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb12-4"><a></a>  <span class="fu">geom_area</span>(<span class="at">stat =</span> <span class="st">"function"</span>, <span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>),</span>
<span id="cb12-5"><a></a>            <span class="at">fill =</span> <span class="st">"lightgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">xlim =</span> <span class="fu">c</span>(height_90th, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb12-6"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> height_90th, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> height_90th, <span class="at">y =</span> <span class="fl">0.02</span>,</span>
<span id="cb12-8"><a></a>           <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Trees above %.1f m</span><span class="sc">\n</span><span class="st">are in tallest 10%%"</span>, height_90th),</span>
<span id="cb12-9"><a></a>           <span class="at">hjust =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tree Height (m)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb12-11"><a></a>       <span class="at">title =</span> <span class="st">"Identifying Tallest Trees"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/qnorm-visual-1.png" width="960" class="r-stretch"></section>
<section id="using-dnorm-for-relative-likelihood" class="slide level2">
<h2>Using <code>dnorm()</code> for relative likelihood</h2>
<p>Which tree height is most common in our forest: 17m, 20m, or 23m? (Or, how likely are these heights?)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="co"># Find relative likelihood at different heights</span></span>
<span id="cb13-2"><a></a>heights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">23</span>) <span class="co"># Example heights to compare</span></span>
<span id="cb13-3"><a></a>densities <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(heights, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb13-4"><a></a>densities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08065691 0.13298076 0.08065691</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a><span class="co"># Plot relative likelihoods</span></span>
<span id="cb15-2"><a></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">30</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb15-3"><a></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb15-4"><a></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> heights, <span class="at">y =</span> densities),</span>
<span id="cb15-5"><a></a>             <span class="fu">aes</span>(<span class="at">y =</span> y), <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> heights),</span>
<span id="cb15-7"><a></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="fu">dnorm</span>(x, <span class="dv">20</span>, <span class="dv">3</span>)),</span>
<span id="cb15-8"><a></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb15-9"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tree Height (m)"</span>, <span class="at">y =</span> <span class="st">"Relative Likelihood"</span>,</span>
<span id="cb15-10"><a></a>       <span class="at">title =</span> <span class="st">"Height Probabilities in the Forest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/dnorm-visual-1.png" width="960" class="r-stretch"><p>Trees closest to 20m are most common, with likelihood decreasing as we move away.</p>
</section>
<section id="practical-uses-of-normal-distribution-functions" class="slide level2">
<h2>Practical uses of normal distribution functions</h2>
<p>These functions help us answer questions like:</p>
<ul>
<li>What proportion of trees are between 18m and 22m tall?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a><span class="co"># Probability between 18m and 22m - calculate the difference</span></span>
<span id="cb16-2"><a></a>prob_between <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="dv">22</span>, <span class="dv">20</span>, <span class="dv">3</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">3</span>)</span>
<span id="cb16-3"><a></a>prob_between</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4950149</code></pre>
</div>
</div>
<ul>
<li>How tall are the top 5% of trees?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a><span class="co"># Height of tallest 5% of trees</span></span>
<span id="cb18-2"><a></a>tall_threshold <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.95</span>, <span class="dv">20</span>, <span class="dv">3</span>)</span>
<span id="cb18-3"><a></a>tall_threshold</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24.93456</code></pre>
</div>
</div>
<ul>
<li>What are the height thresholds for “extreme” trees (top 1% and bottom 1%)?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a><span class="co"># Height thresholds for "extreme" trees</span></span>
<span id="cb20-2"><a></a>extreme_thresholds <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>), <span class="dv">20</span>, <span class="dv">3</span>)</span>
<span id="cb20-3"><a></a>extreme_thresholds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.02096 26.97904</code></pre>
</div>
</div>
</section></section>
<section>
<section id="the-standard-normal-curve" class="title-slide slide level1 center">
<h1>The standard normal curve</h1>

</section>
<section id="standardising-variables" class="slide level2">
<h2>Standardising variables</h2>
<p>We can convert any normal distribution to a standard form where:</p>
<p><span class="math display"> X \sim N(\mu, \sigma^2) \rightarrow Z \sim N(0, 1) </span></p>
<h3 id="why-standardise">Why standardise?</h3>
<p>Standardising helps us:</p>
<ol type="1">
<li>Compare measurements on different scales</li>
<li>Identify unusual values (e.g., z &gt; 2 is unusual)</li>
<li>Calculate probabilities using standard normal tables</li>
</ol>
<p>Formula: <span class="math display">z = \frac{x - \mu}{\sigma}</span> (subtract mean, divide by SD)</p>
</section>
<section id="comparing-different-species" class="slide level2">
<h2>Comparing different species</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a><span class="co"># Create data for two tree species</span></span>
<span id="cb22-2"><a></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-3"><a></a>species1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)  <span class="co"># Tall species</span></span>
<span id="cb22-4"><a></a>species2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">2</span>)  <span class="co"># Shorter species</span></span>
<span id="cb22-5"><a></a></span>
<span id="cb22-6"><a></a><span class="co"># Plot original heights</span></span>
<span id="cb22-7"><a></a><span class="fu">data.frame</span>(</span>
<span id="cb22-8"><a></a>  <span class="at">height =</span> <span class="fu">c</span>(species1, species2),</span>
<span id="cb22-9"><a></a>  <span class="at">species =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Species 1"</span>, <span class="st">"Species 2"</span>), <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb22-10"><a></a>) <span class="sc">|&gt;</span></span>
<span id="cb22-11"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb22-12"><a></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb22-13"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tree Height (m)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb22-14"><a></a>       <span class="at">title =</span> <span class="st">"Original Height Distributions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/standard-species-1.png" width="960" class="r-stretch"></section>
<section id="after-standardisation" class="slide level2">
<h2>After standardisation</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a><span class="co"># Convert to z-scores</span></span>
<span id="cb23-2"><a></a>z1 <span class="ot">&lt;-</span> <span class="fu">scale</span>(species1)</span>
<span id="cb23-3"><a></a>z2 <span class="ot">&lt;-</span> <span class="fu">scale</span>(species2)</span>
<span id="cb23-4"><a></a></span>
<span id="cb23-5"><a></a><span class="co"># Plot standardised distributions</span></span>
<span id="cb23-6"><a></a><span class="fu">data.frame</span>(</span>
<span id="cb23-7"><a></a>  <span class="at">zscore =</span> <span class="fu">c</span>(z1, z2),</span>
<span id="cb23-8"><a></a>  <span class="at">species =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Species 1"</span>, <span class="st">"Species 2"</span>), <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb23-9"><a></a>) <span class="sc">|&gt;</span></span>
<span id="cb23-10"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> zscore, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb23-11"><a></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Z-score"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb23-13"><a></a>       <span class="at">title =</span> <span class="st">"Standardised Distributions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/z-scores-1.png" width="960" class="r-stretch"></section>
<section id="example" class="slide level2">
<h2>Example</h2>
<p>A z-score of 2 means:</p>
<ul>
<li>Species 1: trees above 26 m</li>
<li>Species 2: trees above 19 m</li>
<li>Both are equally tall for their species</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a><span class="co"># Calculate z-scores for specific heights</span></span>
<span id="cb24-2"><a></a>z_26 <span class="ot">&lt;-</span> (<span class="dv">26</span> <span class="sc">-</span> <span class="dv">20</span>) <span class="sc">/</span> <span class="dv">3</span></span>
<span id="cb24-3"><a></a>z_26</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>z_19 <span class="ot">&lt;-</span> (<span class="dv">19</span> <span class="sc">-</span> <span class="dv">15</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb26-2"><a></a>z_19</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
</section>
<section id="working-with-standardised-data-the-standard-normal-curve" class="slide level2">
<h2>Working with standardised data: The standard normal curve</h2>
<p>Once we standardise our data to z-scores, we can calculate probabilities without knowing the original mean or standard deviation.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a><span class="co"># Create a visual of the standard normal curve</span></span>
<span id="cb28-2"><a></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb28-3"><a></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.3</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> <span class="st">"Mean = 0"</span>) <span class="sc">+</span></span>
<span id="cb28-6"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Z-score"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb28-7"><a></a>       <span class="at">title =</span> <span class="st">"Standard Normal Distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/standard_curve_visual-1.png" width="960" class="r-stretch"></section>
<section id="answering-questions-with-standardised-data" class="slide level2">
<h2>Answering questions with standardised data</h2>
<ol type="1">
<li><code>pnorm()</code>: What proportion of values fall below a given z-score?</li>
<li><code>qnorm()</code>: What z-score corresponds to a specific percentile?</li>
<li><code>dnorm()</code>: How likely is a specific z-score to occur?</li>
</ol>
<p>Let’s see how these help us understand our tree height data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a><span class="co"># Example: For a tree with z-score = 1.5 (taller than average)</span></span>
<span id="cb29-2"><a></a><span class="co"># What percentage of trees are shorter than this tree?</span></span>
<span id="cb29-3"><a></a><span class="fu">pnorm</span>(<span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9331928</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a></a><span class="co"># Example: How tall must a tree be to be in the tallest 5%?</span></span>
<span id="cb31-2"><a></a><span class="co"># (Find the z-score at the 95th percentile)</span></span>
<span id="cb31-3"><a></a><span class="fu">qnorm</span>(<span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.644854</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a></a><span class="co"># Example: Compare likelihood of average height vs. very tall trees</span></span>
<span id="cb33-2"><a></a><span class="fu">dnorm</span>(<span class="dv">0</span>)<span class="sc">/</span><span class="fu">dnorm</span>(<span class="dv">2</span>)  <span class="co"># How much more common is z=0 compared to z=2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.389056</code></pre>
</div>
</div>
</section>
<section id="visualising-standard-normal-functions" class="slide level2">
<h2>Visualising standard normal functions</h2>
<p>The blue shaded area shows <code>pnorm(1)</code> = 0.84, meaning 84% of trees have a z-score less than 1.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a><span class="co"># Create a visual showing pnorm in action</span></span>
<span id="cb35-2"><a></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb35-3"><a></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a></a>  <span class="fu">geom_area</span>(<span class="at">stat =</span> <span class="st">"function"</span>, <span class="at">fun =</span> dnorm,</span>
<span id="cb35-5"><a></a>            <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb35-6"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb35-7"><a></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.3</span>,</span>
<span id="cb35-8"><a></a>           <span class="at">label =</span> <span class="st">"pnorm(1) = 0.84</span><span class="sc">\n</span><span class="st">84% of values</span><span class="sc">\n</span><span class="st">below z=1"</span>) <span class="sc">+</span></span>
<span id="cb35-9"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Z-score"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb35-10"><a></a>       <span class="at">title =</span> <span class="st">"Using pnorm() with the Standard Normal Curve"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/standard_functions_visual-1.png" width="960" class="r-stretch"></section>
<section id="beyond-the-normal-distribution" class="slide level2">
<h2>Beyond the normal distribution</h2>
<p>Different data types need different distributions:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a><span class="co"># Create sequence for x-axis</span></span>
<span id="cb36-2"><a></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb36-3"><a></a></span>
<span id="cb36-4"><a></a><span class="co"># Create data frame for plotting</span></span>
<span id="cb36-5"><a></a>distributions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb36-6"><a></a>  <span class="at">x =</span> <span class="fu">rep</span>(x, <span class="dv">3</span>),</span>
<span id="cb36-7"><a></a>  <span class="at">density =</span> <span class="fu">c</span>(</span>
<span id="cb36-8"><a></a>    <span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">5</span>),        <span class="co"># t-distribution</span></span>
<span id="cb36-9"><a></a>    <span class="fu">dchisq</span>(x <span class="sc">+</span> <span class="dv">4</span>, <span class="at">df =</span> <span class="dv">3</span>),<span class="co"># chi-square (shifted)</span></span>
<span id="cb36-10"><a></a>    <span class="fu">dnorm</span>(x)              <span class="co"># normal for comparison</span></span>
<span id="cb36-11"><a></a>  ),</span>
<span id="cb36-12"><a></a>  <span class="at">Distribution =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"t"</span>, <span class="st">"Chi-square"</span>, <span class="st">"Normal"</span>), <span class="at">each =</span> <span class="dv">100</span>)</span>
<span id="cb36-13"><a></a>)</span>
<span id="cb36-14"><a></a></span>
<span id="cb36-15"><a></a><span class="co"># Plot distributions</span></span>
<span id="cb36-16"><a></a><span class="fu">ggplot</span>(distributions, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density, <span class="at">colour =</span> Distribution)) <span class="sc">+</span></span>
<span id="cb36-17"><a></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-18"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb36-19"><a></a>       <span class="at">title =</span> <span class="st">"Different Types of Data, Different Distributions"</span>) <span class="sc">+</span></span>
<span id="cb36-20"><a></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/other-distributions-1.png" width="960" class="r-stretch"></section>
<section id="beyond-the-normal-distribution-1" class="slide level2">
<h2>Beyond the normal distribution</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a></a><span class="co"># Plot distributions</span></span>
<span id="cb37-2"><a></a><span class="fu">ggplot</span>(distributions, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density, <span class="at">colour =</span> Distribution)) <span class="sc">+</span></span>
<span id="cb37-3"><a></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb37-5"><a></a>    <span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb37-6"><a></a>    <span class="at">title =</span> <span class="st">"Different Types of Data, Different Distributions"</span></span>
<span id="cb37-7"><a></a>  ) <span class="sc">+</span></span>
<span id="cb37-8"><a></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/other-distributions2-1.png" width="960" class="r-stretch"><h3 id="we-use-these-for">We use these for:</h3>
<ul>
<li>Comparing means of small samples (t-distribution)</li>
<li>Analysing counts and proportions (Chi-square)</li>
<li>Testing other hypotheses (many more distributions)</li>
</ul>
<p>We’ll learn when to use each one as we need them.</p>
</section></section>
<section>
<section id="sampling-and-sampling-distributions" class="title-slide slide level1 center">
<h1>Sampling and sampling distributions</h1>

</section>
<section id="what-is-a-sample" class="slide level2">
<h2>What is a sample?</h2>
<p>A sample is a subset of a population used to represent the entire group. It allows us to make inferences about the population without examining every member.</p>
<ul>
<li><strong>Population</strong>: all possible measurements</li>
<li><strong>Sample</strong>: a subset of the population</li>
<li><strong>Sample size</strong>: number of measurements in the sample</li>
<li><strong>Sampling distribution</strong>: the distribution of sample means from multiple samples</li>
</ul>
</section>
<section id="sampling-distribution" class="slide level2">
<h2>Sampling distribution</h2>
<p>A sampling distribution tells us:</p>
<ul>
<li>How sample statistics (like means) vary</li>
<li>What patterns emerge when we take many samples</li>
<li>Why we get different results with different samples</li>
</ul>
<p>Think of it as <strong>distribution of sample statistics</strong>, not individual measurements. <strong>Your variable and all its values are a <em>single</em> number in this distribution.</strong></p>
</section>
<section id="taking-samples-from-our-rainfall-data" class="slide level2">
<h2>Taking samples from our rainfall data</h2>
<p>Let’s take samples from our skewed rainfall data and see what happens:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a><span class="co"># Our population: all rainfall measurements (simulated)</span></span>
<span id="cb38-2"><a></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb38-3"><a></a>rainfall_population <span class="ot">&lt;-</span> rainfall_data<span class="sc">$</span>rainfall</span>
<span id="cb38-4"><a></a></span>
<span id="cb38-5"><a></a><span class="co"># Take a small sample of 5 days</span></span>
<span id="cb38-6"><a></a>small_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(rainfall_population, <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb38-7"><a></a></span>
<span id="cb38-8"><a></a><span class="co"># Calculate the sample mean</span></span>
<span id="cb38-9"><a></a><span class="fu">mean</span>(small_sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.49786</code></pre>
</div>
</div>
<p>If we take another sample, we get a different mean:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a></a><span class="co"># Take another sample</span></span>
<span id="cb40-2"><a></a>another_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(rainfall_population, <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb40-3"><a></a><span class="fu">mean</span>(another_sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.656836</code></pre>
</div>
</div>
<p>Each sample gives us a slightly different estimate of the true mean rainfall.</p>
</section>
<section id="distribution-of-sample-means-for-rainfall" class="slide level2">
<h2>Distribution of sample means for rainfall</h2>
<p>What happens if we take many samples and look at all their means?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a></a><span class="co"># Take 1000 samples of size 5 and calculate their means</span></span>
<span id="cb42-2"><a></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb42-3"><a></a>rain_means_n5 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(rainfall_population, <span class="at">size =</span> <span class="dv">5</span>)))</span>
<span id="cb42-4"><a></a></span>
<span id="cb42-5"><a></a><span class="co"># Plot the distribution of sample means</span></span>
<span id="cb42-6"><a></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">sample_mean =</span> rain_means_n5), <span class="fu">aes</span>(<span class="at">x =</span> sample_mean)) <span class="sc">+</span></span>
<span id="cb42-7"><a></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(rainfall_population),</span>
<span id="cb42-9"><a></a>             <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb42-10"><a></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">mean</span>(rainfall_population) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">80</span>,</span>
<span id="cb42-11"><a></a>           <span class="at">label =</span> <span class="st">"Population mean"</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb42-12"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample Mean Rainfall (mm)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb42-13"><a></a>       <span class="at">title =</span> <span class="st">"Distribution of Sample Means (n = 5)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/many_rainfall_samples-1.png" width="960" class="r-stretch"><p>Notice how the sample means are distributed around the true population mean, but the distribution is still somewhat skewed.</p>
</section>
<section id="effect-of-sample-size-on-rainfall-means" class="slide level2">
<h2>Effect of sample size on rainfall means</h2>
<p>What happens when we increase our sample size?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a></a><span class="co"># Take 1000 samples of different sizes</span></span>
<span id="cb43-2"><a></a><span class="fu">set.seed</span>(<span class="dv">404</span>)</span>
<span id="cb43-3"><a></a>rain_means_n1 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(rainfall_population, <span class="at">size =</span> <span class="dv">1</span>)))</span>
<span id="cb43-4"><a></a><span class="co"># We already have n5 from previous slide</span></span>
<span id="cb43-5"><a></a>rain_means_n15 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(rainfall_population, <span class="at">size =</span> <span class="dv">15</span>)))</span>
<span id="cb43-6"><a></a>rain_means_n20 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(rainfall_population, <span class="at">size =</span> <span class="dv">20</span>)))</span>
<span id="cb43-7"><a></a>rain_means_n30 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(rainfall_population, <span class="at">size =</span> <span class="dv">30</span>)))</span>
<span id="cb43-8"><a></a>rain_means_n100 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(rainfall_population, <span class="at">size =</span> <span class="dv">100</span>)))</span>
<span id="cb43-9"><a></a></span>
<span id="cb43-10"><a></a><span class="co"># Combine data for comparison with more sample sizes</span></span>
<span id="cb43-11"><a></a>rain_means_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-12"><a></a>  <span class="at">sample_mean =</span> <span class="fu">c</span>(rain_means_n1, rain_means_n5, rain_means_n15,</span>
<span id="cb43-13"><a></a>                 rain_means_n20, rain_means_n30, rain_means_n100),</span>
<span id="cb43-14"><a></a>  <span class="at">sample_size =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">100</span>), <span class="at">each =</span> <span class="dv">1000</span>),</span>
<span id="cb43-15"><a></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">100</span>))</span>
<span id="cb43-16"><a></a>)</span>
<span id="cb43-17"><a></a></span>
<span id="cb43-18"><a></a><span class="co"># Create faceted plot</span></span>
<span id="cb43-19"><a></a><span class="fu">ggplot</span>(rain_means_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_mean)) <span class="sc">+</span></span>
<span id="cb43-20"><a></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb43-21"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(rainfall_population),</span>
<span id="cb43-22"><a></a>             <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb43-23"><a></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sample_size, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>,</span>
<span id="cb43-24"><a></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">sample_size =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">"n ="</span>, x))) <span class="sc">+</span></span>
<span id="cb43-25"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample Mean Rainfall (mm)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb43-26"><a></a>       <span class="at">title =</span> <span class="st">"Effect of Sample Size on Distribution of Sample Means"</span>) <span class="sc">+</span></span>
<span id="cb43-27"><a></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightgrey"</span>),</span>
<span id="cb43-28"><a></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/rainfall_sample_sizes-1.png" width="960" class="r-stretch"><p>As sample size increases, something remarkable happens:</p>
<ol type="1">
<li>The distribution becomes more symmetrical and bell-shaped</li>
<li>The spread of sample means decreases</li>
<li>The distribution approaches a normal distribution - <strong>did it become better with 100 samples?</strong></li>
</ol>
</section>
<section id="zoomed-in" class="slide level2">
<h2>Zoomed-in</h2>
<p>What happens when we increase our sample size?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a></a><span class="fu">ggplot</span>(rain_means_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_mean)) <span class="sc">+</span></span>
<span id="cb44-2"><a></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb44-3"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(rainfall_population),</span>
<span id="cb44-4"><a></a>             <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sample_size, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>,</span>
<span id="cb44-6"><a></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">sample_size =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">"n ="</span>, x))) <span class="sc">+</span></span>
<span id="cb44-7"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample Mean Rainfall (mm)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb44-8"><a></a>       <span class="at">title =</span> <span class="st">"Effect of Sample Size on Distribution of Sample Means"</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightgrey"</span>),</span>
<span id="cb44-10"><a></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/rainfall_sample_sizes_zoom-1.png" width="960" class="r-stretch"><p>As sample size increases, something remarkable happens:</p>
<ol type="1">
<li>The distribution becomes more symmetrical and bell-shaped</li>
<li>The spread of sample means decreases</li>
<li>The distribution approaches a normal distribution</li>
</ol>
</section></section>
<section>
<section id="the-central-limit-theorem" class="title-slide slide level1 center">
<h1>The Central Limit Theorem</h1>
<blockquote>
<p>I know of scarcely anything so apt to impress the imagination as the wonderful form of cosmic order expressed by the law of frequency of error. The law would have been personified by the Greeks if they had known of it. It reigns with serenity and complete self-effacement amidst the wildest confusion. The larger the mob, the greater the apparent anarchy, the more perfect is its sway. It is the supreme law of unreason.”</p>
</blockquote>
<p>– Sir Francis Galton <a href="https://www.ucl.ac.uk/taxome/jim/Mim/galton.html">(source)</a> (1822-1911)</p>
</section>
<section id="what-is-the-clt" class="slide level2">
<h2>What is the CLT?</h2>
<p>The Central Limit Theorem (CLT) states that:</p>
<p>When we take sufficiently large random samples from any population:</p>
<ol type="1">
<li>The distribution of <strong>sample means</strong> will be approximately normal</li>
<li>The mean of the sample means will equal the population mean</li>
<li>The standard deviation of sample means (standard error) equals <span class="math inline">\frac{\sigma}{\sqrt{n}}</span></li>
</ol>
<p>This is true regardless of the shape of the original population distribution.</p>
</section>
<section id="comparing-original-data-with-sampling-distribution" class="slide level2">
<h2>Comparing original data with sampling distribution</h2>
<p>Let’s compare our original skewed rainfall data with the distribution of sample means:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a></a><span class="co"># Plot original population and sampling distributions</span></span>
<span id="cb45-2"><a></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> rainfall_population), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb45-3"><a></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb45-4"><a></a>                <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb45-6"><a></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(rainfall_population),</span>
<span id="cb45-7"><a></a>                           <span class="at">sd =</span> <span class="fu">sd</span>(rainfall_population)),</span>
<span id="cb45-8"><a></a>                <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb45-9"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Rainfall (mm)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb45-10"><a></a>       <span class="at">title =</span> <span class="st">"Original Population</span><span class="sc">\n</span><span class="st">(Skewed)"</span>)</span>
<span id="cb45-11"><a></a></span>
<span id="cb45-12"><a></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> rain_means_n30), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb45-13"><a></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb45-14"><a></a>                <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb45-15"><a></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb45-16"><a></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(rain_means_n30),</span>
<span id="cb45-17"><a></a>                           <span class="at">sd =</span> <span class="fu">sd</span>(rain_means_n30)),</span>
<span id="cb45-18"><a></a>                <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb45-19"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample Mean Rainfall (mm)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb45-20"><a></a>       <span class="at">title =</span> <span class="st">"Sampling Distribution</span><span class="sc">\n</span><span class="st">(n = 30)"</span>)</span>
<span id="cb45-21"><a></a></span>
<span id="cb45-22"><a></a><span class="fu">plot_grid</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/clt_comparison-1.png" width="960" class="r-stretch"><p>Even with skewed data, the sampling distribution becomes normal as sample size increases!</p>
</section>
<section id="the-clt-with-binary-biological-data" class="slide level2">
<h2>The CLT with binary biological data</h2>
<p>In biology, many processes have binary outcomes: a gene is expressed or not, a cell divides or not, an organism survives or dies. Let’s demonstrate the CLT with gene expression data:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a></a><span class="co"># Create a binary population (gene expression: 0 = off, 1 = on)</span></span>
<span id="cb46-2"><a></a><span class="co"># Assume the gene is expressed in 30% of cells</span></span>
<span id="cb46-3"><a></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb46-4"><a></a>n_cells <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb46-5"><a></a>p_expressed <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb46-6"><a></a>gene_expression <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_cells, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p_expressed)</span>
<span id="cb46-7"><a></a></span>
<span id="cb46-8"><a></a><span class="co"># Plot the original population distribution</span></span>
<span id="cb46-9"><a></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">expression =</span> <span class="fu">factor</span>(gene_expression)), <span class="fu">aes</span>(<span class="at">x =</span> expression)) <span class="sc">+</span></span>
<span id="cb46-10"><a></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb46-11"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gene Expression (0 = off, 1 = on)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb46-12"><a></a>       <span class="at">title =</span> <span class="st">"Original Population: Binary Gene Expression"</span>,</span>
<span id="cb46-13"><a></a>       <span class="at">subtitle =</span> <span class="st">"Gene expressed in 30% of cells"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/binary_population-1.png" width="960" class="r-stretch"><p>This is a highly non-normal distribution - it’s discrete with only two possible values!</p>
</section>
<section id="sampling-distribution-with-increasing-sample-sizes" class="slide level2">
<h2>Sampling distribution with increasing sample sizes</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a></a><span class="co"># Define sample sizes (powers of 2)</span></span>
<span id="cb47-2"><a></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>, <span class="dv">256</span>, <span class="dv">512</span>, <span class="dv">1024</span>, <span class="dv">2048</span>)</span>
<span id="cb47-3"><a></a></span>
<span id="cb47-4"><a></a><span class="co"># Function to generate sample means for a given sample size</span></span>
<span id="cb47-5"><a></a>generate_sample_means <span class="ot">&lt;-</span> <span class="cf">function</span>(sample_size, <span class="at">n_samples =</span> <span class="dv">1000</span>) {</span>
<span id="cb47-6"><a></a>  <span class="fu">replicate</span>(n_samples, <span class="fu">mean</span>(<span class="fu">sample</span>(gene_expression, <span class="at">size =</span> sample_size, <span class="at">replace =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb47-7"><a></a>}</span>
<span id="cb47-8"><a></a></span>
<span id="cb47-9"><a></a><span class="co"># Generate sample means for each sample size</span></span>
<span id="cb47-10"><a></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb47-11"><a></a>all_sample_means <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sample_sizes, generate_sample_means)</span>
<span id="cb47-12"><a></a><span class="fu">names</span>(all_sample_means) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"n ="</span>, sample_sizes)</span>
<span id="cb47-13"><a></a></span>
<span id="cb47-14"><a></a><span class="co"># Combine into a data frame</span></span>
<span id="cb47-15"><a></a>sample_means_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-16"><a></a>  <span class="at">sample_mean =</span> <span class="fu">unlist</span>(all_sample_means),</span>
<span id="cb47-17"><a></a>  <span class="at">sample_size =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">names</span>(all_sample_means), <span class="at">each =</span> <span class="dv">1000</span>),</span>
<span id="cb47-18"><a></a>                      <span class="at">levels =</span> <span class="fu">names</span>(all_sample_means))</span>
<span id="cb47-19"><a></a>)</span>
<span id="cb47-20"><a></a></span>
<span id="cb47-21"><a></a><span class="co"># Create faceted plot with density plots instead of histograms</span></span>
<span id="cb47-22"><a></a><span class="fu">ggplot</span>(sample_means_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_mean)) <span class="sc">+</span></span>
<span id="cb47-23"><a></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"purple"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb47-24"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(gene_expression),</span>
<span id="cb47-25"><a></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb47-26"><a></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sample_size, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb47-27"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample Mean (Proportion of Cells with Gene Expressed)"</span>,</span>
<span id="cb47-28"><a></a>       <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb47-29"><a></a>       <span class="at">subtitle =</span> <span class="st">"Red line shows true population mean (0.3)"</span>) <span class="sc">+</span></span>
<span id="cb47-30"><a></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lavender"</span>),</span>
<span id="cb47-31"><a></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/binary_clt_samples-1.png" width="960" class="r-stretch"><p>Even with the most non-normal data possible (binary data), the sampling distribution of means becomes normal with sufficient sample size.</p>
</section>
<section id="another-example-seed-germination-discrete-data" class="slide level2">
<h2>Another example: Seed germination (discrete data)</h2>
<p>Let’s explore another example with a discrete, highly skewed distribution:</p>
<p>In ecological restoration, practitioners need to estimate germination rates of native seeds. Imagine each seed has only a 10% chance of germinating (p = 0.1).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a></a><span class="co"># Create a binomial population - number of germinated seeds in batches of 20</span></span>
<span id="cb48-2"><a></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb48-3"><a></a>n_trials <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># 20 seeds per batch</span></span>
<span id="cb48-4"><a></a>p_success <span class="ot">&lt;-</span> <span class="fl">0.1</span>  <span class="co"># 10% germination rate</span></span>
<span id="cb48-5"><a></a>n_batches <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 10,000 batches to create our "population"</span></span>
<span id="cb48-6"><a></a></span>
<span id="cb48-7"><a></a><span class="co"># Generate the population data</span></span>
<span id="cb48-8"><a></a>germination_population <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_batches, <span class="at">size =</span> n_trials, <span class="at">prob =</span> p_success)</span>
<span id="cb48-9"><a></a></span>
<span id="cb48-10"><a></a><span class="co"># Plot the population distribution</span></span>
<span id="cb48-11"><a></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">germinated =</span> germination_population), <span class="fu">aes</span>(<span class="at">x =</span> germinated)) <span class="sc">+</span></span>
<span id="cb48-12"><a></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb48-13"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb48-14"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of Seeds Germinated (out of 20)"</span>,</span>
<span id="cb48-15"><a></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb48-16"><a></a>       <span class="at">title =</span> <span class="st">"Seed Germination Population Distribution"</span>,</span>
<span id="cb48-17"><a></a>       <span class="at">subtitle =</span> <span class="st">"Binomial(n=20, p=0.1): Discrete and highly skewed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/seed_germination_population-1.png" width="960" class="r-stretch"><p>This distribution is: - Discrete (only whole numbers of seeds can germinate) - Highly skewed (most batches have very few germinating seeds) - Very different from our continuous rainfall example</p>
</section>
<section id="sampling-distribution-for-seed-germination-data" class="slide level2">
<h2>Sampling distribution for seed germination data</h2>
<p>What happens when we take samples from this discrete, skewed distribution?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a></a><span class="co"># Take samples of different sizes and calculate means</span></span>
<span id="cb49-2"><a></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb49-3"><a></a>seed_means_n5 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(germination_population, <span class="at">size =</span> <span class="dv">5</span>)))</span>
<span id="cb49-4"><a></a>seed_means_n30 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(germination_population, <span class="at">size =</span> <span class="dv">30</span>)))</span>
<span id="cb49-5"><a></a></span>
<span id="cb49-6"><a></a><span class="co"># Calculate theoretical standard error for n=30</span></span>
<span id="cb49-7"><a></a>se_n30 <span class="ot">&lt;-</span> <span class="fu">sd</span>(germination_population)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">30</span>)</span>
<span id="cb49-8"><a></a></span>
<span id="cb49-9"><a></a><span class="co"># Plot the original population vs. sampling distributions</span></span>
<span id="cb49-10"><a></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> germination_population), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb49-11"><a></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb49-12"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb49-13"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Seeds Germinated"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb49-14"><a></a>       <span class="at">title =</span> <span class="st">"Original Population</span><span class="sc">\n</span><span class="st">(Discrete &amp; Skewed)"</span>)</span>
<span id="cb49-15"><a></a></span>
<span id="cb49-16"><a></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> seed_means_n5), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb49-17"><a></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.2</span>,</span>
<span id="cb49-18"><a></a>                <span class="at">fill =</span> <span class="st">"lightgreen"</span>, <span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb49-19"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(germination_population),</span>
<span id="cb49-20"><a></a>             <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb49-21"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample Mean (n = 5)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb49-22"><a></a>       <span class="at">title =</span> <span class="st">"Sampling Distribution</span><span class="sc">\n</span><span class="st">Small Samples"</span>)</span>
<span id="cb49-23"><a></a></span>
<span id="cb49-24"><a></a><span class="co"># For n=30, use density scale and properly scaled normal curve</span></span>
<span id="cb49-25"><a></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> seed_means_n30), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb49-26"><a></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.1</span>,</span>
<span id="cb49-27"><a></a>                <span class="at">fill =</span> <span class="st">"lightgreen"</span>, <span class="at">colour =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb49-28"><a></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(germination_population),</span>
<span id="cb49-29"><a></a>             <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb49-30"><a></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb49-31"><a></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(germination_population),</span>
<span id="cb49-32"><a></a>                           <span class="at">sd =</span> se_n30),</span>
<span id="cb49-33"><a></a>                <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-34"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample Mean (n = 30)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb49-35"><a></a>       <span class="at">title =</span> <span class="st">"Sampling Distribution</span><span class="sc">\n</span><span class="st">Larger Samples"</span>) <span class="sc">+</span></span>
<span id="cb49-36"><a></a>  <span class="co"># Set x-axis limits to focus on the relevant range</span></span>
<span id="cb49-37"><a></a>  <span class="fu">xlim</span>(<span class="fu">mean</span>(germination_population) <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>se_n30,</span>
<span id="cb49-38"><a></a>       <span class="fu">mean</span>(germination_population) <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>se_n30)</span>
<span id="cb49-39"><a></a></span>
<span id="cb49-40"><a></a><span class="co"># Arrange plots</span></span>
<span id="cb49-41"><a></a><span class="fu">plot_grid</span>(p1, p2, p3, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="lecture-04-new_files/figure-revealjs/seed_sampling_distribution-1.png" width="960" class="r-stretch"><p>Even with discrete, highly skewed data, the CLT still applies:</p>
<ul>
<li>The sampling distribution becomes more normal as sample size increases</li>
<li>The sampling distribution centers on the population mean (≈ 2, since 20 × 0.1 = 2)</li>
<li>The standard error decreases as sample size increases</li>
</ul>
</section>
<section id="standard-error-measuring-the-precision-of-sample-means" class="slide level2">
<h2>Standard error: Measuring the precision of sample means</h2>
<p>The standard error (SE) tells us how much sample means typically vary:</p>
<p><span class="math display">SE = \frac{\sigma}{\sqrt{n}}</span></p>
<p>Where: - <span class="math inline">\sigma</span> is the population standard deviation - <span class="math inline">n</span> is the sample size</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a></a><span class="co"># Calculate theoretical standard errors</span></span>
<span id="cb50-2"><a></a>pop_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(rainfall_population)</span>
<span id="cb50-3"><a></a>se_n5 <span class="ot">&lt;-</span> pop_sd <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb50-4"><a></a>se_n15 <span class="ot">&lt;-</span> pop_sd <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">15</span>)</span>
<span id="cb50-5"><a></a>se_n30 <span class="ot">&lt;-</span> pop_sd <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">30</span>)</span>
<span id="cb50-6"><a></a></span>
<span id="cb50-7"><a></a><span class="co"># Compare standard errors</span></span>
<span id="cb50-8"><a></a>se_n5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.89159</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a></a>se_n15</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.66946</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a></a>se_n30</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.180487</code></pre>
</div>
</div>
<p>As sample size increases, standard error decreases, making our estimates more precise.</p>
</section>
<section id="standard-error-vs.-standard-deviation" class="slide level2">
<h2>Standard error vs.&nbsp;standard deviation</h2>
<p>While we have been using the standard deviation to measure variability in our data, the standard error measures variability in our <strong>sample means</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a></a><span class="co"># Create comparison table between Standard Deviation and Standard Error</span></span>
<span id="cb56-2"><a></a>sd_se_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb56-3"><a></a>  <span class="at">Aspect =</span> <span class="fu">c</span>(<span class="st">"Definition"</span>, <span class="st">"Formula"</span>, <span class="st">"Measures"</span>, <span class="st">"Effect of sample size"</span>, <span class="st">"Typical use"</span>),</span>
<span id="cb56-4"><a></a>  <span class="at">Standard_Deviation =</span> <span class="fu">c</span>(</span>
<span id="cb56-5"><a></a>    <span class="st">"Measures spread of individual data points around their mean"</span>,</span>
<span id="cb56-6"><a></a>    <span class="st">"σ = √[Σ(x-μ)²/N] or s = √[Σ(x-x̄)²/(n-1)]"</span>,</span>
<span id="cb56-7"><a></a>    <span class="st">"Variability within a dataset"</span>,</span>
<span id="cb56-8"><a></a>    <span class="st">"Unaffected by sample size"</span>,</span>
<span id="cb56-9"><a></a>    <span class="st">"Describing the spread of data in a single sample"</span></span>
<span id="cb56-10"><a></a>  ),</span>
<span id="cb56-11"><a></a>  <span class="at">Standard_Error =</span> <span class="fu">c</span>(</span>
<span id="cb56-12"><a></a>    <span class="st">"Measures precision of a sample statistic (usually the mean)"</span>,</span>
<span id="cb56-13"><a></a>    <span class="st">"SE = σ/√n or SE = s/√n"</span>,</span>
<span id="cb56-14"><a></a>    <span class="st">"Variability between sample means from the same population"</span>,</span>
<span id="cb56-15"><a></a>    <span class="st">"Decreases as sample size increases (∝ 1/√n)"</span>,</span>
<span id="cb56-16"><a></a>    <span class="st">"Inferential statistics, confidence intervals, hypothesis testing"</span></span>
<span id="cb56-17"><a></a>  )</span>
<span id="cb56-18"><a></a>)</span>
<span id="cb56-19"><a></a></span>
<span id="cb56-20"><a></a><span class="fu">kable</span>(sd_se_comparison, </span>
<span id="cb56-21"><a></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Aspect"</span>, <span class="st">"Standard Deviation (SD)"</span>, <span class="st">"Standard Error (SE)"</span>),</span>
<span id="cb56-22"><a></a>      <span class="at">caption =</span> <span class="st">"Standard Deviation vs. Standard Error"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top">
<caption>Standard Deviation vs.&nbsp;Standard Error</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 40%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Aspect</th>
<th style="text-align: left;">Standard Deviation (SD)</th>
<th style="text-align: left;">Standard Error (SE)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Definition</td>
<td style="text-align: left;">Measures spread of individual data points around their mean</td>
<td style="text-align: left;">Measures precision of a sample statistic (usually the mean)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Formula</td>
<td style="text-align: left;">σ = √[Σ(x-μ)²/N] or s = √[Σ(x-x̄)²/(n-1)]</td>
<td style="text-align: left;">SE = σ/√n or SE = s/√n</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Measures</td>
<td style="text-align: left;">Variability within a dataset</td>
<td style="text-align: left;">Variability between sample means from the same population</td>
</tr>
<tr class="even">
<td style="text-align: left;">Effect of sample size</td>
<td style="text-align: left;">Unaffected by sample size</td>
<td style="text-align: left;">Decreases as sample size increases (∝ 1/√n)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Typical use</td>
<td style="text-align: left;">Describing the spread of data in a single sample</td>
<td style="text-align: left;">Inferential statistics, confidence intervals, hypothesis testing</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="practical-implications-of-the-clt" class="slide level2">
<h2>Practical implications of the CLT</h2>
<p>The Central Limit Theorem is fundamental to statistics because:</p>
<ol type="1">
<li>It allows us to make inferences about populations using samples
<ul>
<li>We can estimate population parameters with known precision</li>
<li>We can construct confidence intervals</li>
</ul></li>
<li>It works for any population distribution
<ul>
<li>Even when data is not normally distributed (like our rainfall)</li>
<li>Enables parametric tests for non-normal data (with sufficient sample size)</li>
</ul></li>
<li>It explains why the normal distribution is so important
<ul>
<li>Many natural phenomena represent averages of many small effects</li>
<li>This is why we see normal distributions so often in nature</li>
</ul></li>
</ol>
</section></section>
<section id="thanks" class="title-slide slide level1 center">
<h1>Thanks!</h1>
<p>This presentation is based on the <a href="https://github.com/usyd-soles-edu/soles-revealjs">SOLES Quarto reveal.js template</a> and is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>
<!-- Links -->


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/ENVX-resources\.github\.io\/ENVX1002-lectures\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>