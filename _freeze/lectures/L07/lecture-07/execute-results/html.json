{
  "hash": "677800fbf83c516954a377e4acfd663b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Topic 7 -- Non-parametric tests\nauthor: Floris van Ogtrop\nformat: soles-revealjs\nembed-resources: true\n---\n\n\n\n\n\n\n# Evaluation task (Week 8)\n\n- Testing materials in weeks 2 - 6 (No non-parametric test).\n- **No GenAI**: we will check.\n- Practice before the test using the practice test found on Canvas\n\n# Learning Outcomes\n\n## At the end of this week, you will be able to:\n\n1. **Explain the rationale** for using non-parametric tests, including when to choose them over parametric tests due to violations of assumptions (e.g., non-normality, ordinal data).\n2. Differentiate between:\n   - The **Wilcoxon signed-rank tests** (for one-sample or paired data),\n   - The **Mann-Whitney U test** (AKA Wilcoxon rank-sum test) for two independent samples, and\n   - The **Chi-squared test**, including tests for proportions (goodness-of-fit) and association (independence).\n3. **Apply and interpret** Wilcoxon and Mann-Whitney tests in R, for one-sample paired samples or two independent samples\n4. **Conduct and interpret** Chi-squared tests in R, including:\n   - Chi-squared test of independence to examine association between two categorical variables\n   - Chi-squared goodness-of-fit test to compare observed proportions with expected proportions\n   - Check assumptions for the Chi-squared test (e.g., expected cell counts) and understand potential limitations and alternatives (e.g., Fisherâ€™s Exact Test).\n5. **Present and visualise results** from all non-parametric tests using RStudio output, with appropriate interpretation and reporting.\n\n# Parametric vs non-parametric methods\n\n## Overview\n\n### Parametric methods\n\nDepends on the assumption that the data is normally distributed with mean $\\mu$ and standard deviation $\\sigma$ ,e.g. $t$-test, ANOVA, linear regression.\n\n::: fragment\n### Non-parametric methods\n\nDo **not** make *any* assumptions about the distribution of the data. \n\n**Uses other properties** e.g. ranking of the data, e.g. Wilcoxon signed-rank test, Mann-Whitney U test, Kruskal-Wallis test.\n:::\n\n## Rank-based tests\n\n### General idea\n\n- Rank the data e.g., from smallest to largest.\n- Replace the data with their ranks.\n- Perform the test on the ranks.\n\n## It's *kind of* like a transformation...\n\n. . .\n\nFor the **Wilcoxon signed-rank test** suppose we have the following data:\n\n| sample: | [12]{style=\"color:black\"} | 10 | 8 | 6 | 4 | 10 | 8 | 6 | 10 |\n|--------|----|----|----|---|---|---|---|----|----|\n\n. . .\n\nWe arrange the data in ascending order (*similar values are given the same colour for illustration*):\n\n| ordered: | [4]{style=\"color:blue\"} | [6]{style=\"color:orange\"} | [6]{style=\"color:orange\"} | [8]{style=\"color:green\"} | [8]{style=\"color:green\"} | [10]{style=\"color:red\"} | [10]{style=\"color:red\"} | [10]{style=\"color:red\"} | [12]{style=\"color:violet\"} |\n|--------|----|----|----|---|---|---|---|----|----|\n\n. . .\n\nThen, we rank the data:\n\n| ordered ranks: | [1]{style=\"color:blue\"} | [2]{style=\"color:orange\"} | [3]{style=\"color:orange\"} | [4]{style=\"color:green\"} | [5]{style=\"color:green\"} | [6]{style=\"color:red\"} | [7]{style=\"color:red\"} | [8]{style=\"color:red\"} | [9]{style=\"color:violet\"} |\n|--------|----|----|----|---|---|---|---|----|----|\n\n. . .\n\nFinally, ranks that are *tied* are given the average rank:\n\n| final rank: | [1]{style=\"color:blue\"} | [2.5]{style=\"color:orange\"} | [2.5]{style=\"color:orange\"} | [4.5]{style=\"color:green\"} | [4.5]{style=\"color:green\"} | [7]{style=\"color:red\"} | [7]{style=\"color:red\"} | [7]{style=\"color:red\"} | [9]{style=\"color:violet\"} |\n|--------|----|----|----|---|---|---|---|----|----|\n\n**These ranks are then used to perform the test, instead of the original data.**\n\n\n# Use case\n\n## Two-sample $t$-test\n\nConsider two sets of **identical** data that compares between a group **A** and **B**, where one contains an outlier.\n\n:::: columns\n::: column\n**Data:**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(tidyverse)\n\n# for display only\ndata.frame(A = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10),\n           B = c(7, 8, 9, 10, 11, 12, 13, 14, 15, 16)) %>%\n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"obgvkciwvn\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#obgvkciwvn table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#obgvkciwvn thead, #obgvkciwvn tbody, #obgvkciwvn tfoot, #obgvkciwvn tr, #obgvkciwvn td, #obgvkciwvn th {\n  border-style: none;\n}\n\n#obgvkciwvn p {\n  margin: 0;\n  padding: 0;\n}\n\n#obgvkciwvn .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#obgvkciwvn .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#obgvkciwvn .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#obgvkciwvn .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#obgvkciwvn .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#obgvkciwvn .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#obgvkciwvn .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#obgvkciwvn .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#obgvkciwvn .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#obgvkciwvn .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#obgvkciwvn .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#obgvkciwvn .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#obgvkciwvn .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#obgvkciwvn .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#obgvkciwvn .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#obgvkciwvn .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#obgvkciwvn .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#obgvkciwvn .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#obgvkciwvn .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#obgvkciwvn .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#obgvkciwvn .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#obgvkciwvn .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#obgvkciwvn .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#obgvkciwvn .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#obgvkciwvn .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#obgvkciwvn .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#obgvkciwvn .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#obgvkciwvn .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#obgvkciwvn .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#obgvkciwvn .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#obgvkciwvn .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#obgvkciwvn .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#obgvkciwvn .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#obgvkciwvn .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#obgvkciwvn .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#obgvkciwvn .gt_left {\n  text-align: left;\n}\n\n#obgvkciwvn .gt_center {\n  text-align: center;\n}\n\n#obgvkciwvn .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#obgvkciwvn .gt_font_normal {\n  font-weight: normal;\n}\n\n#obgvkciwvn .gt_font_bold {\n  font-weight: bold;\n}\n\n#obgvkciwvn .gt_font_italic {\n  font-style: italic;\n}\n\n#obgvkciwvn .gt_super {\n  font-size: 65%;\n}\n\n#obgvkciwvn .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#obgvkciwvn .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#obgvkciwvn .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#obgvkciwvn .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#obgvkciwvn .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#obgvkciwvn .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#obgvkciwvn .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#obgvkciwvn .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#obgvkciwvn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"A\">A</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"B\">B</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">1</td>\n<td headers=\"B\" class=\"gt_row gt_right\">7</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">2</td>\n<td headers=\"B\" class=\"gt_row gt_right\">8</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">3</td>\n<td headers=\"B\" class=\"gt_row gt_right\">9</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">4</td>\n<td headers=\"B\" class=\"gt_row gt_right\">10</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">5</td>\n<td headers=\"B\" class=\"gt_row gt_right\">11</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">6</td>\n<td headers=\"B\" class=\"gt_row gt_right\">12</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">7</td>\n<td headers=\"B\" class=\"gt_row gt_right\">13</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">8</td>\n<td headers=\"B\" class=\"gt_row gt_right\">14</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">9</td>\n<td headers=\"B\" class=\"gt_row gt_right\">15</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">10</td>\n<td headers=\"B\" class=\"gt_row gt_right\">16</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::\n\n::: column\n**Data *with* outlier:**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ndata.frame(A = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10),\n           B = c(7, 8, 9, 10, 11, 12, 13, 14, 15, 200)) %>%\n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ghjixyaudi\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ghjixyaudi table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ghjixyaudi thead, #ghjixyaudi tbody, #ghjixyaudi tfoot, #ghjixyaudi tr, #ghjixyaudi td, #ghjixyaudi th {\n  border-style: none;\n}\n\n#ghjixyaudi p {\n  margin: 0;\n  padding: 0;\n}\n\n#ghjixyaudi .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ghjixyaudi .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ghjixyaudi .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ghjixyaudi .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ghjixyaudi .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ghjixyaudi .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ghjixyaudi .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ghjixyaudi .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ghjixyaudi .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ghjixyaudi .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ghjixyaudi .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ghjixyaudi .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ghjixyaudi .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ghjixyaudi .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ghjixyaudi .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ghjixyaudi .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ghjixyaudi .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ghjixyaudi .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ghjixyaudi .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ghjixyaudi .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ghjixyaudi .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ghjixyaudi .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ghjixyaudi .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ghjixyaudi .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ghjixyaudi .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ghjixyaudi .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ghjixyaudi .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ghjixyaudi .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ghjixyaudi .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ghjixyaudi .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ghjixyaudi .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ghjixyaudi .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ghjixyaudi .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ghjixyaudi .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ghjixyaudi .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ghjixyaudi .gt_left {\n  text-align: left;\n}\n\n#ghjixyaudi .gt_center {\n  text-align: center;\n}\n\n#ghjixyaudi .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ghjixyaudi .gt_font_normal {\n  font-weight: normal;\n}\n\n#ghjixyaudi .gt_font_bold {\n  font-weight: bold;\n}\n\n#ghjixyaudi .gt_font_italic {\n  font-style: italic;\n}\n\n#ghjixyaudi .gt_super {\n  font-size: 65%;\n}\n\n#ghjixyaudi .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ghjixyaudi .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ghjixyaudi .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ghjixyaudi .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ghjixyaudi .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ghjixyaudi .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ghjixyaudi .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ghjixyaudi .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ghjixyaudi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"A\">A</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"B\">B</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">1</td>\n<td headers=\"B\" class=\"gt_row gt_right\">7</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">2</td>\n<td headers=\"B\" class=\"gt_row gt_right\">8</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">3</td>\n<td headers=\"B\" class=\"gt_row gt_right\">9</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">4</td>\n<td headers=\"B\" class=\"gt_row gt_right\">10</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">5</td>\n<td headers=\"B\" class=\"gt_row gt_right\">11</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">6</td>\n<td headers=\"B\" class=\"gt_row gt_right\">12</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">7</td>\n<td headers=\"B\" class=\"gt_row gt_right\">13</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">8</td>\n<td headers=\"B\" class=\"gt_row gt_right\">14</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">9</td>\n<td headers=\"B\" class=\"gt_row gt_right\">15</td></tr>\n    <tr><td headers=\"A\" class=\"gt_row gt_right\">10</td>\n<td headers=\"B\" class=\"gt_row gt_right\">200</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n:::\n::::\n\n## Should there be a difference?\n\nWithout the outlier, the data would have been normally distributed.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ndf <- data.frame(\n  group = rep(c(\"A\", \"B\"), each = 10),\n  response = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10,\n            7, 8, 9, 10, 11, 12, 13, 14, 15, 16))\n\ndf_with_outlier <- data.frame(\n  group = rep(c(\"A\", \"B\"), each = 10),\n  response = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10,\n            7, 8, 9, 10, 11, 12, 13, 14, 15, 200))\n\nggplot(df, aes(x = response, y = group)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\n\n## Outlier\n\nThe same data, but with a single outlier in group **B**:\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(df_with_outlier, aes(x = response, y = group)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n\n## Analysis\n\nIf we perform $t$-tests on both data sets, we get the following results:\n\n:::: columns\n::: column\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- t.test(response ~ group, data = df)\nfit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  response by group\nt = -4.4313, df = 18, p-value = 0.0003224\nalternative hypothesis: true difference in means between group A and group B is not equal to 0\n95 percent confidence interval:\n -8.844662 -3.155338\nsample estimates:\nmean in group A mean in group B \n            5.5            11.5 \n```\n\n\n:::\n:::\n\n\n\nResults indicate that there is a statistically significant difference between the two groups (t~18~ = -4.4, p < 0.05).\n:::\n::: column\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit2 <- t.test(response ~ group, data = df_with_outlier)\nfit2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  response by group\nt = -1.2882, df = 9.0461, p-value = 0.2297\nalternative hypothesis: true difference in means between group A and group B is not equal to 0\n95 percent confidence interval:\n -67.21615  18.41615\nsample estimates:\nmean in group A mean in group B \n            5.5            29.9 \n```\n\n\n:::\n:::\n\n\n\nResults indicate that the two groups are **not** significantly different (t~18~ = -2.1, p = 0.23).\n:::\n::::\n\n. . .\n\nThe real difference between the two groups is *obscured* by the outlier. **Type II error** (false negative)?\n\n\n# Non-parametric alternatives\n\n## When to use\n\n1. If assumptions are met (normality, homogeneity of variance), use parametric tests as they are more powerful and efficient than non-parametric tests.\n2. If the normality assumption is violated, transform the data and check for normality again (*optional*).\n3. **Non-parametric tests are a good way to deal with circumstances in which parametric tests perform \"poorly\".**\n\n## What to use\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(tidyverse)\nlibrary(gt)\n\ndf <- tibble(\n  parametric = c(\"One-sample t-test\", \"Two-sample t-test\", \"ANOVA\", \"Pearson's correlation\"),\n  non_parametric = c(\"Wilcoxon signed-rank test\", \"Mann-Whitney U test\", \"Kruskal-Wallis test\", \"Spearman's rank correlation\"))\n\ngt(df) %>%\n  cols_label(parametric = \"Parametric tests\", non_parametric = \"Non-parametric counterpart\") %>%\n  tab_options(\n    table.font.size = px(24),\n    column_labels.font.weight = \"bold\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"szbzsicnno\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#szbzsicnno table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#szbzsicnno thead, #szbzsicnno tbody, #szbzsicnno tfoot, #szbzsicnno tr, #szbzsicnno td, #szbzsicnno th {\n  border-style: none;\n}\n\n#szbzsicnno p {\n  margin: 0;\n  padding: 0;\n}\n\n#szbzsicnno .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 24px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#szbzsicnno .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#szbzsicnno .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#szbzsicnno .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#szbzsicnno .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#szbzsicnno .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#szbzsicnno .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#szbzsicnno .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#szbzsicnno .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#szbzsicnno .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#szbzsicnno .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#szbzsicnno .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#szbzsicnno .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#szbzsicnno .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#szbzsicnno .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#szbzsicnno .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#szbzsicnno .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#szbzsicnno .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#szbzsicnno .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#szbzsicnno .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#szbzsicnno .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#szbzsicnno .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#szbzsicnno .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#szbzsicnno .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#szbzsicnno .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#szbzsicnno .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#szbzsicnno .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#szbzsicnno .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#szbzsicnno .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#szbzsicnno .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#szbzsicnno .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#szbzsicnno .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#szbzsicnno .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#szbzsicnno .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#szbzsicnno .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#szbzsicnno .gt_left {\n  text-align: left;\n}\n\n#szbzsicnno .gt_center {\n  text-align: center;\n}\n\n#szbzsicnno .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#szbzsicnno .gt_font_normal {\n  font-weight: normal;\n}\n\n#szbzsicnno .gt_font_bold {\n  font-weight: bold;\n}\n\n#szbzsicnno .gt_font_italic {\n  font-style: italic;\n}\n\n#szbzsicnno .gt_super {\n  font-size: 65%;\n}\n\n#szbzsicnno .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#szbzsicnno .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#szbzsicnno .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#szbzsicnno .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#szbzsicnno .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#szbzsicnno .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#szbzsicnno .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#szbzsicnno .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#szbzsicnno div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"parametric\">Parametric tests</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"non_parametric\">Non-parametric counterpart</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"parametric\" class=\"gt_row gt_left\">One-sample t-test</td>\n<td headers=\"non_parametric\" class=\"gt_row gt_left\">Wilcoxon signed-rank test</td></tr>\n    <tr><td headers=\"parametric\" class=\"gt_row gt_left\">Two-sample t-test</td>\n<td headers=\"non_parametric\" class=\"gt_row gt_left\">Mann-Whitney U test</td></tr>\n    <tr><td headers=\"parametric\" class=\"gt_row gt_left\">ANOVA</td>\n<td headers=\"non_parametric\" class=\"gt_row gt_left\">Kruskal-Wallis test</td></tr>\n    <tr><td headers=\"parametric\" class=\"gt_row gt_left\">Pearson's correlation</td>\n<td headers=\"non_parametric\" class=\"gt_row gt_left\">Spearman's rank correlation</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\nAll of the non-parametric techniques above convert the data into **ranks** before performing the test.\n\n. . .\n\n::: callout-note\nWe will focus on the **Wilcoxon signed-rank test** and the **Mann-Whitney U test**.\n:::\n\n\n# Wilcoxon signed-rank test\n\nAltenrative to the one-sample $t$-test and the paired $t$-test.\n\n## Overview\n\nThe Wilcoxon signed-rank test is a non-parametric test used to compare two related samples, matched pairs, or repeated measures on a single sample.\n\n. . .\n\nIs an alternative to:\n\n- One-sample $t$-test\n- Paired $t$-test\n\n## Assumptions\n\n. . .\n\n- Data comes from the same population\n- Data are randomly and independently sampled\n\n. . .\n\nBasically, used in same situations as the one-sample or paired $t$-test, but when the data is not normally distributed but **still symmetric**.\n\n## Calculating ranks\n\nIf comparing two groups, the ranks are calculated as follows:\n\n::: incremental\n1. Calculate the difference $D$ between the two groups.\n2. Rank the absolute values of the differences in ascending order.\n3. Assign the sign of the difference to the rank.\n4. Sum the ranks for each group -- **zero differences are ignored**.\n:::\n\n. . .\n\n::: callout-note\nSee Slide 5 to recall how ranks are calculated, but we will show another example in the next slide.\n:::\n\n\n# Example: Paired data\n\n## Weight gain\n\nWe measured weight gain in chickens before and after a diet.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nweight <- c(2.5, 3.5, 3.5, 3.4)\nweight_after <- c(4, 5, 5, 4.6)\n\ndf <- tibble(\n  chicken = 1:4,\n  weight = weight,\n  weight_after = weight_after)\n\ngt(df) %>%\n  tab_options(\n    table.font.size = px(24),\n    column_labels.font.weight = \"bold\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"qyzwlqoahp\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qyzwlqoahp table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qyzwlqoahp thead, #qyzwlqoahp tbody, #qyzwlqoahp tfoot, #qyzwlqoahp tr, #qyzwlqoahp td, #qyzwlqoahp th {\n  border-style: none;\n}\n\n#qyzwlqoahp p {\n  margin: 0;\n  padding: 0;\n}\n\n#qyzwlqoahp .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 24px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qyzwlqoahp .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qyzwlqoahp .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#qyzwlqoahp .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#qyzwlqoahp .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qyzwlqoahp .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qyzwlqoahp .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qyzwlqoahp .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qyzwlqoahp .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qyzwlqoahp .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qyzwlqoahp .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qyzwlqoahp .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qyzwlqoahp .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qyzwlqoahp .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qyzwlqoahp .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qyzwlqoahp .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qyzwlqoahp .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qyzwlqoahp .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qyzwlqoahp .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qyzwlqoahp .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qyzwlqoahp .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qyzwlqoahp .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qyzwlqoahp .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qyzwlqoahp .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qyzwlqoahp .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qyzwlqoahp .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qyzwlqoahp .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qyzwlqoahp .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qyzwlqoahp .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qyzwlqoahp .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#qyzwlqoahp .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qyzwlqoahp .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qyzwlqoahp .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qyzwlqoahp .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qyzwlqoahp .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qyzwlqoahp .gt_left {\n  text-align: left;\n}\n\n#qyzwlqoahp .gt_center {\n  text-align: center;\n}\n\n#qyzwlqoahp .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qyzwlqoahp .gt_font_normal {\n  font-weight: normal;\n}\n\n#qyzwlqoahp .gt_font_bold {\n  font-weight: bold;\n}\n\n#qyzwlqoahp .gt_font_italic {\n  font-style: italic;\n}\n\n#qyzwlqoahp .gt_super {\n  font-size: 65%;\n}\n\n#qyzwlqoahp .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qyzwlqoahp .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qyzwlqoahp .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qyzwlqoahp .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qyzwlqoahp .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qyzwlqoahp .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qyzwlqoahp .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#qyzwlqoahp .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#qyzwlqoahp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"chicken\">chicken</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"weight\">weight</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"weight_after\">weight_after</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"chicken\" class=\"gt_row gt_right\">1</td>\n<td headers=\"weight\" class=\"gt_row gt_right\">2.5</td>\n<td headers=\"weight_after\" class=\"gt_row gt_right\">4.0</td></tr>\n    <tr><td headers=\"chicken\" class=\"gt_row gt_right\">2</td>\n<td headers=\"weight\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"weight_after\" class=\"gt_row gt_right\">5.0</td></tr>\n    <tr><td headers=\"chicken\" class=\"gt_row gt_right\">3</td>\n<td headers=\"weight\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"weight_after\" class=\"gt_row gt_right\">5.0</td></tr>\n    <tr><td headers=\"chicken\" class=\"gt_row gt_right\">4</td>\n<td headers=\"weight\" class=\"gt_row gt_right\">3.4</td>\n<td headers=\"weight_after\" class=\"gt_row gt_right\">4.6</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n### Is there a significant increase in weight gain after the diet?\n\n## Rank values\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ndf %>%\n  mutate(D = weight_after - weight) %>%\n  mutate(Sign = ifelse(D > 0, \"+\", \"-\")) %>%\n  mutate(rank = rank(abs(D))) %>%\n  mutate(\"Signed rank\" = ifelse(D > 0, rank, -rank)) %>%\n  gt() %>%\n  tab_options(\n    table.font.size = px(24),\n    column_labels.font.weight = \"bold\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"xwlaqtzxbi\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xwlaqtzxbi table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xwlaqtzxbi thead, #xwlaqtzxbi tbody, #xwlaqtzxbi tfoot, #xwlaqtzxbi tr, #xwlaqtzxbi td, #xwlaqtzxbi th {\n  border-style: none;\n}\n\n#xwlaqtzxbi p {\n  margin: 0;\n  padding: 0;\n}\n\n#xwlaqtzxbi .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 24px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xwlaqtzxbi .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xwlaqtzxbi .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xwlaqtzxbi .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xwlaqtzxbi .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwlaqtzxbi .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwlaqtzxbi .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwlaqtzxbi .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xwlaqtzxbi .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xwlaqtzxbi .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xwlaqtzxbi .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xwlaqtzxbi .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xwlaqtzxbi .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xwlaqtzxbi .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xwlaqtzxbi .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xwlaqtzxbi .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xwlaqtzxbi .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xwlaqtzxbi .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xwlaqtzxbi .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwlaqtzxbi .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xwlaqtzxbi .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xwlaqtzxbi .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xwlaqtzxbi .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwlaqtzxbi .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xwlaqtzxbi .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xwlaqtzxbi .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwlaqtzxbi .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwlaqtzxbi .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xwlaqtzxbi .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwlaqtzxbi .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xwlaqtzxbi .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwlaqtzxbi .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwlaqtzxbi .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwlaqtzxbi .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwlaqtzxbi .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwlaqtzxbi .gt_left {\n  text-align: left;\n}\n\n#xwlaqtzxbi .gt_center {\n  text-align: center;\n}\n\n#xwlaqtzxbi .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xwlaqtzxbi .gt_font_normal {\n  font-weight: normal;\n}\n\n#xwlaqtzxbi .gt_font_bold {\n  font-weight: bold;\n}\n\n#xwlaqtzxbi .gt_font_italic {\n  font-style: italic;\n}\n\n#xwlaqtzxbi .gt_super {\n  font-size: 65%;\n}\n\n#xwlaqtzxbi .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xwlaqtzxbi .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xwlaqtzxbi .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xwlaqtzxbi .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xwlaqtzxbi .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xwlaqtzxbi .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xwlaqtzxbi .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#xwlaqtzxbi .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#xwlaqtzxbi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"chicken\">chicken</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"weight\">weight</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"weight_after\">weight_after</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sign\">Sign</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"rank\">rank</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Signed-rank\">Signed rank</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"chicken\" class=\"gt_row gt_right\">1</td>\n<td headers=\"weight\" class=\"gt_row gt_right\">2.5</td>\n<td headers=\"weight_after\" class=\"gt_row gt_right\">4.0</td>\n<td headers=\"D\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"rank\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Signed rank\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"chicken\" class=\"gt_row gt_right\">2</td>\n<td headers=\"weight\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"weight_after\" class=\"gt_row gt_right\">5.0</td>\n<td headers=\"D\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"rank\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Signed rank\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"chicken\" class=\"gt_row gt_right\">3</td>\n<td headers=\"weight\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"weight_after\" class=\"gt_row gt_right\">5.0</td>\n<td headers=\"D\" class=\"gt_row gt_right\">1.5</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"rank\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Signed rank\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"chicken\" class=\"gt_row gt_right\">4</td>\n<td headers=\"weight\" class=\"gt_row gt_right\">3.4</td>\n<td headers=\"weight_after\" class=\"gt_row gt_right\">4.6</td>\n<td headers=\"D\" class=\"gt_row gt_right\">1.2</td>\n<td headers=\"Sign\" class=\"gt_row gt_right\">+</td>\n<td headers=\"rank\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Signed rank\" class=\"gt_row gt_right\">1</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n::: callout-note\nThe order of the ranks is based on the **absolute** values of the differences; the signs are assigned afterward.\n:::\n\n## Hypothesis\n\n> Is there a significant increase in weight gain after the diet?\n\n$$H_0: \\mu_{\\text{before}} = \\mu_{\\text{after}}$$\n$$H_1: \\mu_{\\text{before}} < \\mu_{\\text{after}}$$\n\n. . .\n\nIn words: \n\n- $H_0$: There is no difference in weight gain before and after the diet.\n- $H_1$: There is an increase in weight gain after the diet.\n\n---\n\nAlternatively, since the data is paired, we may also consider hypotheses based on the differences between the two groups:\n\n$$H_0: \\mu_D = 0$$\n$$H_1: \\mu_D > 0$$\n\nwhere $D$ is the difference between the two groups.\n\n## Assumptions\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\np1 <- ggplot(df, aes(x = weight_after - weight)) +\n  geom_histogram(bins = 10)\np2 <- ggplot(df, aes(sample = weight_after - weight)) +\n  stat_qq() +\n  stat_qq_line()\np3 <- ggplot(df, aes(x = \"\", y = weight_after - weight)) +\n  geom_boxplot()\n\nlibrary(patchwork)\np1 + p2 + p3\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-10-1.png){width=960}\n:::\n:::\n\n\n\nWith so few data points, we may want to use a formal test to check for normality.\n\n## Assumptions\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nshapiro.test(df$weight_after - df$weight)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  df$weight_after - df$weight\nW = 0.62978, p-value = 0.001241\n```\n\n\n:::\n:::\n\n\n\nResults indicate that the data significantly deviates from normality (W = 0.63, p < 0.05). We will use the Wilcoxon signed-rank test.\n\n## Performing the test\n\n### In R\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nwilcox.test(x = df$weight_after, y = df$weight,  # data must be x - y\n  alternative = \"greater\",  # because we are testing for an increase\n  paired = TRUE)            # because the data is paired\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  df$weight_after and df$weight\nV = 10, p-value = 0.04449\nalternative hypothesis: true location shift is greater than 0\n```\n\n\n:::\n:::\n\n\n\nwhere `V` is the sum of the signed ranks.\n\n::: fragment\nThe results indicate that there is a **significant increase in weight gain** after the diet (V = 10, p < 0.05). \n:::\n\n\n# Example: One-sample data\n\n## Beetle consumption in lizards\n\nResearchers investigated differences in beetle\nconsumption between two size classes of eastern horned lizard (*Phrynosoma\ndouglassi brevirostre*) \n\n- **Larger class**: adult females.\n- **Smaller class**: adult males, yearling females.\n\n. . .\n\n**Focusing on just the smaller size class** (for now) -- it was hypothesised that this size class would eat a minimum of 100 beetles per day.\n\n## Hypothesis\n\nDoes the average smaller size class lizard eat about 100 beetles per day?\n\n$$H_0: \\mu = 100$$\n$$H_1: \\mu \\neq 100$$\n\n### Dataset [Download](data/beetle.csv)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbeetle <- read_csv(\"data/beetle.csv\")\nglimpse(beetle)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 45\nColumns: 2\n$ SIZE    <chr> \"small\", \"small\", \"small\", \"small\", \"small\", \"small\", \"small\",â€¦\n$ BEETLES <dbl> 256, 209, 0, 0, 0, 44, 49, 117, 6, 0, 0, 75, 34, 13, 0, 90, 0,â€¦\n```\n\n\n:::\n:::\n\n\n\n## First, check assumptions\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\np1 <- ggplot(beetle, aes(x = BEETLES)) +\n  geom_histogram(bins = 10)\np2 <- ggplot(beetle, aes(sample = BEETLES)) +\n  stat_qq() +\n  stat_qq_line()\np3 <- ggplot(beetle, aes(x = \"\", y = BEETLES)) +\n  geom_boxplot()\n\nlibrary(patchwork)\np1 + p2 + p3\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-14-1.png){width=960}\n:::\n:::\n\n\n\nIs it normally distributed?\n\n## Run the test\n\nThe Wilcoxon signed-rank test for one sample can be performed as follows:\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nbeetle %>%\n  filter(SIZE == \"small\") %>%  # filter only the smaller size class\n  pull(BEETLES) %>%            # convert to a vector using pull()\n  wilcox.test(mu = 100)        # wilcox.text(x, mu)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  .\nV = 92, p-value = 0.09755\nalternative hypothesis: true location is not equal to 100\n```\n\n\n:::\n:::\n\n\n\n. . .\n\nResults indicate that the average number of beetles consumed by the smaller size class lizard is **not significantly different from 100** (V = 92, p = 0.1).\n\n. . .\n\n::: callout-important\nWe are unable to make a conclusion about effect size from non-parametric tests as the information is lost when the data is transformed into ranks.\n:::\n\n\n# Mann-Whitney U test\n\nAlternative to the **two-sample $t$-test**. \n\n*Also called the Mannâ€“Whitneyâ€“Wilcoxon (MWW/MWU), **Wilcoxon rank-sum test (what R calls it)**, or Wilcoxonâ€“Mannâ€“Whitney test*.\n\n## About\n\n- A **non-parametric test** used to compare two independent samples similar to the two-sample $t$-test.\n- Like the Wilcoxon signed-rank test, it uses **ranks** to perform the test and does not assume normality. \n- It is also more *relaxed* in that it does not assume symmetry in the distribution of the data -- instead, it assumes that the two groups have the same shape/distribution.\n\n\n# Example: Back to the lizards\n\n## Beetle consumption in lizards\n\nResearchers investigated differences in beetle consumption between two size classes of eastern horned lizard (*Phrynosoma douglassi brevirostre*) \n\n- **Larger class**: adult females.\n- **Smaller class**: adult males, yearling females.\n\nWe will now compare the number of beetles consumed by the **larger** and **smaller** size classes of lizards.\n\n## Hypotheses\n\n> Are the number of beetles consumed by the larger and smaller size classes of lizards different?\n\nLoosely speaking, because we are not assuming symmetry, the most appropriate summary statistic to use when comparing the two groups is the **median**.\n\n$$H_0: median_{\\text{larger}} = median_{\\text{smaller}}$$\n$$H_1: median_{\\text{larger}} \\neq median_{\\text{smaller}}$$\n\nMore accurately, we are testing for a difference in the *distribution* of the two groups.\n\n## Assumptions\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\np1 <- ggplot(beetle, aes(x = BEETLES)) +\n  geom_histogram(bins = 14, position = \"dodge\") +\n  facet_wrap(~SIZE, ncol = 1)\np2 <- ggplot(beetle, aes(x = SIZE, y = BEETLES)) +\n  geom_boxplot()\np3 <- ggplot(beetle, aes(sample = BEETLES)) +\n  stat_qq() +\n  stat_qq_line() +\n  facet_wrap(~SIZE, ncol = 1)\n\nlibrary(patchwork)\np1 + p2 + p3\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n\n\n\nData does not meet the normality assumption.\n\n## Test statistic\n\nThe same function `wilcox.test()` can be used to perform the Mann-Whitney U test.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nwilcox.test(BEETLES ~ SIZE, data = beetle)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  BEETLES by SIZE\nW = 329, p-value = 0.07494\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\n\n- `W` is the sum of the ranks of the *smaller* group.\n- The \"true location shift\" is the median of the larger group minus the median of the smaller group.\n\n::: fragment\nThe results indicate that the number of beetles consumed by the larger and smaller size classes of lizards is **not significantly different** (W = 329, p = 0.07).\n:::\n\n\n# What about transformations?\n\n## Transform, or non-parametric?\n\n::: incremental\n- As usual, there is ongoing debate on whether to transform the data or use non-parametric tests, but the general consensus is to always prefer parametric tests and transformations when assumptions are met using those techniques.\n  - e.g. [Parametric analysis of transformed data is more powerful than non-parametric analysis](https://doi.org/10.1177/001316449105100402)\n- Some argue that non-parametric tests **must** be decided during experimental design and not when the data fails to meet the normality assumption: **as the decision to rank data has implications on the interpretation of the results.**\n  - e.g. [Graphpad Advice: Don't automate the decision to use a nonparametric test](https://www.graphpad.com/guides/prism/latest/statistics/using_a_normality_test_to_choo.htm)\n- The conventional wisdom is to **transform the data** and check for normality if the assumption is not met. If the data is *still* not normal, then use non-parametric tests (after considering the implications on interpretation).\n  - Or, use bootstrapping (next week!).\n\n:::\n\n## Summary\n\n- **Wilcoxon signed-rank test**: alternative to the one-sample $t$-test and paired $t$-test.\n- **Mann-Whitney U test**: alternative to the two-sample $t$-test.\n- **Advantages**: **Robust** to outliers, skewness, and non-normality.\n- **Drawbacks**: Less powerful than parametric tests when assumptions are met, provide no insight into the size of the effect.\n\n\n# Questions?\n\n# Recap\n\n## Parametric and non-parametric alternatives\n\n::: incremental\n- So far, **all** of our techniques have been aimed at comparing **means/medians** of continuous variables.\n- The *assumption of normality* **underpins** these techniques -- if the data is not normally distributed, we have alternatives like *transforming* the data or using *non-parametric tests*.\n- **Does this apply to all data?**\n:::\n\n## A rational assumption?\n\n::: incremental\n- **Are all randomly sampled data normally distributed?**\n- Recall probability distributions (Week 3) -- **normal distribution** is just *one of several* possible distributions of data.\n- It turns out that there are non-parametric techniques that are not just *alternatives* of parametric tests, but **better suited** for certain types of data.\n:::\n\n\n# Categorical data\nSome data are not measured on a continuous scale, but rather as **categories**. \n\n## What are categorical variables?\n\nConsider the following questions:\n\n::: fragment\n\n> A biologist claims that when sampling the Australian Botanical Gardens for butterflies, the ratio of the most dominant colours (red, blue, green, and yellow) is equal. How would you determine if the biologist's claim is true?\n\n> A study was conducted on a population of deer to see if there is a relationship between their age group (young, adult, old) and their preferred type of vegetation (grass, leaves, bark). Is age group of the deer independent of their vegetation preference?\n:::\n\n::: fragment\nHow would you **measure** these variables, and what sort of summary statistics can you use?\n\n:::\n\n\n## Visualising categorical variables\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(ggplot2)\n# generate some butterfly data\nbutterfly_data <- data.frame(\n  color = c(\"red\", \"blue\", \"green\", \"yellow\"),\n  count = c(48, 62, 56, 34)\n)\n\n# plot the data\nggplot(butterfly_data, aes(x = color, y = count)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Butterfly colour distribution\")\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-18-1.png){width=960}\n:::\n:::\n\n\n\nWe can only **count** the number of times a particular category occurs, or the **proportion** of the total that each category represents.\n\n## Types of categorical data\n\n- Rather than measuring a continuous variable, we are interested in **counting** the number of times a particular category occurs, or the **proportion** of the total that each category represents.\n- These are known as **categorical variables**.\n- Generally 3 types of categorical data:\n  - **Nominal**: Categories have no inherent order (e.g. colours, breeds of dogs).\n  - **Ordinal**: Categories have an inherent order (e.g. Likert scales, grades).\n  - **Binary**: Only two mutually exclusive categories (e.g rain or no rain).\n  \n  \n# Chi-squared distribution\n\n## The chi-squared test\n\n- The chi-squared test is perhaps one of the most prominent examples of non-parametric tests.\n- Developed by Karl Pearson in 1900, pronounced \"ki\" as in \"kite\", uses the Greek letter $\\chi$.\n- Actually derived from the normal distribution: a chi-squared distribution is the sum of squared standard normal deviates -- essentially a **folded-over** and **stretched out** normal.\n\n## Chi-squared distribution vs normal distribution\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncurve(dchisq(x, df = 1), from = 0, to = 9, xlim = c(-10, 10), col = \"blue\", lwd = 2, ylab = \"Density\", xlab = \"Value\", main = \"Chi-squared vs. normal\")\ncurve(dnorm(x, mean = 0, sd = 1), from = -9, to = 9, col = \"red\", lwd = 2, add = TRUE)\nabline(v = 0, col = \"black\", lty = 2)\nlegend(\"topright\", legend = c(\"Chi-squared with 1 df\", \"Normal\"), col = c(\"blue\", \"red\"), lwd = 2)\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-19-1.png){width=960}\n:::\n:::\n\n\n\nHow is the chi-squared distribution used in hypothesis testing?\n\n## Butterflies data\n\n> A biologist claims that when sampling the Australian Botanical Gardens for butterflies, the ratio of the most dominant colours (red, blue, green, and yellow) is equal. How would you determine if the biologist's claim is true?\n\nSuppose we have the following data on the colours of butterflies after randomly sampling 200 of them:\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nbutterfly_data %>%\n  knitr::kable()\n```\n\n::: {.cell-output-display}\n\n\n|color  | count|\n|:------|-----:|\n|red    |    48|\n|blue   |    62|\n|green  |    56|\n|yellow |    34|\n\n\n:::\n:::\n\n\n\n## Testing the claim\n\n- If the biologist's claim is true, we would expect the number of butterflies of each colour to be equal.\n- If 200 butterflies were sampled, we would expect 50 of each colour, as the expected frequency of each colour is 200 $\\times$ 0.25 = 50.\n\n\nTherefore:\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ndf <- butterfly_data %>%\n  mutate(expected = 200 * 0.25)\nknitr::kable(df)\n```\n\n::: {.cell-output-display}\n\n\n|color  | count| expected|\n|:------|-----:|--------:|\n|red    |    48|       50|\n|blue   |    62|       50|\n|green  |    56|       50|\n|yellow |    34|       50|\n\n\n:::\n:::\n\n\n\n## Test statistic\n\nThe **test statistic** for the chi-squared test is calculated as:\n\n$$ \\chi^2 = \\sum \\frac{(O - E)^2}{E} $$\n\nwhere $O$ is the observed frequency and $E$ is the expected frequency.\n\n. . .\n\nSo for the butterfly data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nchi_squared <- sum((df$count - df$expected)^2 / df$expected)\nchi_squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 8.8\n```\n\n\n:::\n:::\n\n\n\nThis is the test statistic for one sample. How do we interpret this value?\n\n## Simulate the null distribution\n\nUnder the null hypothesis, the observed frequencies are equal to the expected frequencies i.e. the biologist's claim is true.\n\nSuppose we repeat the sampling process many times, **assuming the null hypothesis is true**, each time calculating the test statistic. What would the distribution of test statistics look like?\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# simulate sampling of 200 butterflies 1000 times under the null hypothesis and plot the distribution of chi-squared values\nset.seed(123)\ncols <- c(\"red\", \"blue\", \"green\", \"yellow\")\nB <- 3000\ntest_statistic <- vector(mode = \"numeric\", length = B)\nfor (i in 1:B) {\n  sim <- sample(\n    x = cols, size = 200, replace = TRUE,\n    prob = c(0.25, 0.25, 0.25, 0.25)\n  )\n  sim_y <- table(sim)\n  test_statistic[i] <- sum((sim_y - 50)^2 / 50)\n}\n\np1 <-\n  ggplot(data.frame(test_statistic), aes(x = test_statistic)) +\n  geom_histogram(aes(y = ..density..), bins = 20, fill = \"blue\", colour = \"black\", alpha = 0.3) +\n  ylim(0, 0.3) +\n  labs(title = \"Simulated distribution of chi-squared values under the null hypothesis\") +\n  xlab(\"Chi-squared value\") +\n  ylab(\"Frequency\")\np1\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-23-1.png){width=1536}\n:::\n:::\n\n\n\n## What does our test statistic tell us?\n\n::: fragment\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\np1 +\n  geom_vline(xintercept = chi_squared, color = \"red\", size = 1) +\n  # label the line\n  annotate(\"text\", x = chi_squared + 1.5, y = 0.25, label = \"Observed value\", color = \"red\", size = 5)\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-24-1.png){width=960}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(test_statistic >= chi_squared)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.034\n```\n\n\n:::\n:::\n\n\n\nComparing our test statistic to the simulated distribution, we can see that the 0.03% of the simulated values are greater than our test statistic. **What does this tell us?**\n:::\n\n## A $\\chi^2$ test\n\nA chi-squared distribution allows us to perform the same hypothesis test without the need for simulation.\n\n. . .\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(data.frame(test_statistic), aes(x = test_statistic)) +\n  geom_histogram(aes(y = ..density..), bins = 20, fill = \"blue\", colour = \"black\", alpha = 0.3) +\n  ylim(0, 0.3) +\n  stat_function(fun = dchisq, args = list(df = 3), color = \"red\", size = 1) +\n  labs(title = \"Simulated distribution of chi-squared values under the null hypothesis\") +\n  xlab(\"Chi-squared value\") +\n  ylab(\"Frequency\")\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-26-1.png){width=960}\n:::\n:::\n\n\n\n## Conclusion?\n\nThe results of the simulation suggest that the observed frequencies of butterfly colours are **significantly different** from the expected frequencies, and we can **reject** the biologist's claim.\n\n## More on the chi-squared distribution\n\n- The chi-squared distribution is **non-symmetric** and **right-skewed**.\n- The shape of the distribution is determined by the **degrees of freedom**, calculated as the number of categories minus 1.\n- As the degrees of freedom increase, the chi-squared distribution approaches a normal distribution due to the **central limit theorem**.\n\n---\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npar(mfrow = c(2, 2))\ncurve(dchisq(x, df = 2), from = 0, to = qchisq(0.995, df = 2), col = \"blue\", lwd = 2, ylab = \"Density\", xlab = \"Value\", main = \"Chi-squared with 2 df\")\ncurve(dchisq(x, df = 10), from = 0, to = qchisq(0.995, df = 10), col = \"blue\", lwd = 2, ylab = \"Density\", xlab = \"Value\", main = \"Chi-squared with 10 df\")\ncurve(dchisq(x, df = 50), from = 0, to = qchisq(0.995, df = 50), col = \"blue\", lwd = 2, ylab = \"Density\", xlab = \"Value\", main = \"Chi-squared with 50 df\")\ncurve(dchisq(x, df = 100), from = 0, to = qchisq(0.995, df = 100), col = \"blue\", lwd = 2, ylab = \"Density\", xlab = \"Value\", main = \"Chi-squared with 100 df\")\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-27-1.png){width=960}\n:::\n:::\n\n\n\n# The Chi-squared test\n\n## Definitions\n\n- **Chi-squared distribution**: a distribution derived from the normal distribution\nthat allows us to determine whether the observed frequencies of a categorical variable differ from the expected frequencies.\n- **Contingency table**: a table that displays the frequency of observations for two or more categorical variables.\n- **Expected frequency**: the frequency that we would expect to observe if the null hypothesis is true.\n- **Observed frequency**: the frequency that we actually observe.\n- **Test statistic**: a **measure** of how much the observed frequencies differ from the expected frequencies, standardised by the expected frequencies.\n\n\n## Types of chi-squared tests\n\n- **Goodness-of-fit test**: used to determine whether the observed frequencies of a categorical variable differ from the expected frequencies.\n- **Test of independence**: used to determine whether there is a relationship between two or more categorical variables.\n- **Test of homogeneity**: used to determine whether the distribution of a categorical variable is the same across different groups.\n\n## Assumptions\n\n- The chi-squared test is a **non-parametric** test, so it does not rely on the assumption of normality. However, it does have some assumptions:\n  - **Independence**: the observations are independent.\n  - **Sample size**: the expected frequency of each category is at least 1, and no more than 20% of the expected frequencies are less than 5.\n  \nThe sample size assumption ensures that the chi-squared distribution is a good approximation of the normal distribution.\n\n\n# Example: Goodness of fit\n\n> A biologist claims that when sampling the Australian Botanical Gardens for butterflies, the ratio of the most dominant colours (red, blue, green, and yellow) is equal. How would you determine if the biologist's claim is true?\n\n## Hypothesis\n\n- **Null hypothesis**: the observed proportion of butterfly colours are equal to the expected proportions of 0.25 each.\n- **Alternative hypothesis**: the observed proportions are not equal.\n\n$$ H_0: p_1 = p_2 = p_3 = p_4 = 0.25 $$\n$$ H_1: \\text{at least one } p_i \\neq 0.25 $$\n\n## Test statistic and check assumptions (in R)\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# chi-squared test for goodness of fit\nfit <- chisq.test(df$count, p = rep(0.25, 4))\n```\n:::\n\n\n\n**Assumptions**\n\nBy performing the chi-squared test, we can check the assumptions of the test by looking at the calculated frequences in the output:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit$observed\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 48 62 56 34\n```\n\n\n:::\n:::\n\n\n\n**Test statistic**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tChi-squared test for given probabilities\n\ndata:  df$count\nX-squared = 8.8, df = 3, p-value = 0.03207\n```\n\n\n:::\n:::\n\n\n\n## Conclusion\n\nThe results of the chi-squared test suggest that the observed frequencies of butterfly colours are **significantly different** from the expected frequencies ($\\chi^2 = 8.8$, $df = 3$, $p < 0.001$). We can reject the null hypothesis and conclude that the biologist's claim is not true.\n\n::: callout-note\nIf you're interested, compare this result to the simulation we performed earlier.\n:::\n\n\n# Example: Test of independence\n\n> A study was conducted on a population of deer to see if there is a relationship between their age group (young, adult, old) and their preferred type of vegetation (grass, leaves, bark). Is age group of the deer independent of their vegetation preference?\n\n## Hypothesis\n\n- **Null hypothesis**: the age group of the deer is independent of their vegetation preference.\n- **Alternative hypothesis**: the age group of the deer is not independent of their vegetation preference.\n\n$$ H_0: \\text{Age group is independent of vegetation preference} $$\n\n> No relationship between the two variables\n\n$$ H_1: \\text{Age group is not independent of vegetation preference} $$\n\n> There is a relationship between the two variables\n\n## Data\n\nSuppose we have the following data on the age group and vegetation preference of 100 deer:\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# create contingency table as matrix with labels\ndeer_data <- matrix(c(20, 30, 10, 10, 10, 20, 10, 10, 10), nrow = 3, byrow = TRUE)\nrownames(deer_data) <- c(\"young\", \"adult\", \"old\")\ncolnames(deer_data) <- c(\"grass\", \"leaves\", \"bark\")\ndeer_data\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      grass leaves bark\nyoung    20     30   10\nadult    10     10   20\nold      10     10   10\n```\n\n\n:::\n:::\n\n\n\n## Test statistic and check assumptions (in R)\n\n**Assumptions** are met as we can see the contingency table in the previous slide.\n\n### Test statistic\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# chi-squared test for independence\nfit <- chisq.test(deer_data) # exclude the age group column\nfit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  deer_data\nX-squared = 13.542, df = 4, p-value = 0.008911\n```\n\n\n:::\n:::\n\n\n\nWe reject the null hypothesis since the p-value is less than 0.05.\n\n## Conclusion\n\nThe results of the chi-squared test suggest that the age group of the deer is **not independent** of their vegetation preference ($\\chi^2 = 12.4$, $df = 4$, $p < 0.001$). We can reject the null hypothesis and conclude that there is a relationship between the age group of the deer and their vegetation preference.\n\n# How do we visualise the differences in a contingency table?\n\n## Mosaic plots\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmosaicplot(deer_data,\n  shade = TRUE,\n  main = \"Deer age group and vegetation preference\"\n)\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-33-1.png){width=960}\n:::\n:::\n\n\n\n## Interpretation\n\n- The area of each rectangle is proportional to the number of observations in that category.\n- The **shading** of each rectangle indicates the **expected** frequency of observations in that category.\n- The **darker** the shading, the **greater** the difference between the observed and expected frequencies.\n- Dotted lines indicate **independence** between the two variables.\n- Solid lines indicate **dependence** between the two variables.\n\n## Association plots\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(vcd)\nassoc(deer_data, shade = TRUE, main = \"Deer age group and vegetation preference\")\n```\n\n::: {.cell-output-display}\n![](lecture-07_files/figure-revealjs/unnamed-chunk-34-1.png){width=960}\n:::\n:::\n\n\n\n## Interpretation\n\n- Size of cells indicate the number of observations in that category.\n- The shadings are made based on the residuals of the chi-squared test (see legend), highlighting which cells contribute most to the chi-squared statistic.\n- Colour of the shadings indicate whether they are more or less frequent than expected (again, see legend).\n\n# What about the test of homogeneity?\n\n## Test of homogeneity vs. test of independence\n\n- The **test of homogeneity** is similar to the **test of independence**, but is used when we have **two or more groups** and we want to determine whether the distribution of a categorical variable is the same across different groups.\n- In general, this means that the null hypothesis is stated differently, and the test statistic is calculated in a slightly different way with different degrees of freedom.\n- Homogeneity\n  - $H_0$: The distribution of the categorical variable is the same across different groups.\n  - $H_1$: The distribution of the categorical variable is not the same across different groups.\n- Independence\n  - $H_0$: The variables of interest are independent.\n  - $H_1$: The variables of interest are not independent.\n  \n## Differences are subtle\n\n- In the test of independence, observational units are collected at random from **a single population** and two (or more) categorical variables are observed for each unit.\n- For the deer example, the experimental design would involve randomly sampling deer and recording their age group and vegetation preference.\n\n> Is age group independent of vegetation preference?\n\n- In the test of homogeneity, the data are collected by randomly sampling from **two or more subgroups**, and the same categorical variable is observed for each unit.\n- For the deer example, the experimental design would have to be modified to sample the vegetation preference of deer from young, adult, and old populations.\n\n> Is the distribution of vegetation preference the same if we compare young, adult, and old deer?\n\n\n# Summary\n\n## When to use a chi-squared test?\n\n- The chi-squared test is not an \"alternative\" to a parametric test, but is **better suited** for certain types of data and requires delibarate experimental design that collects data in a certain way.\n- If we have **categorical data** and we want to determine whether the observed frequencies differ from the expected frequencies, then we can use a **chi-squared test**.\n\n<!-- ## Willows -->\n\n<!-- The diamond leaf willow (*Salix pulcha*) and the Arctic willow (*Salix arctica*) are both found on rocky outcrops in marshy ground in the Arctic tundra. Does the presence of one species affect the presence of the other? -->\n\n<!-- ::: {layout-ncol=2} -->\n<!-- ![*Salix pulcha*. From Wikipedia.](images/salix_pulcha.jpg){#fig-salix_pulcha} -->\n\n<!-- ![*Salix arcica*. From Wikipedia.](images/salix_arctica.jpg){#fig-salix_arctica} -->\n<!-- ::: -->\n\n\n# Thanks!\n\nThis presentation is based on the [SOLES Quarto reveal.js template](https://github.com/usyd-soles-edu/soles-revealjs) and is licensed under a [Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0/).\n\n<!-- Links -->\n",
    "supporting": [
      "lecture-07_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}